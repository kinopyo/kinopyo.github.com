
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Kinopyo Blog</title>
	<meta name="author" content="Qihuan Piao">

	
	<meta name="description" content="Update If you already upgraded to Moutain Lion OSX, you definetly don&#8217;t need this, there is a navtive Reminder app built in :) Original Post &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="http://feeds.feedburner.com/kinopyo" rel="alternate" title="Kinopyo Blog" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
</head>

<body>
	<header id="header" class="inner"><h1><a href="/">Kinopyo Blog</a></h1>
<nav id="main-nav"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
  <li><a href="http://about.me/kinopyo">About</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
  <li><a href="http://about.me/kinopyo">About</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:kinopyo.com">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		
		<a class="twitter" href="http://twitter.com/fantasyday" title="Twitter">Twitter</a>
		
		
		<a class="github" href="https://github.com/kinopyo" title="GitHub">GitHub</a>
		
		
		
		
		
		<a class="rss" href="http://feeds.feedburner.com/kinopyo" title="RSS">RSS</a>
		
	</div>
	<form class="search" action="http://google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:kinopyo.com">
	</form>
</nav>

</header>
  
    <div id="quotes" class="inner">
	<div class="container">
		<ul class="feed"></ul>
	</div>
	<div class="loading">Loading...</div>
</div>
<script src="/javascripts/quote.js"></script>
<script type="text/javascript">
	(function($){
		$('#quotes').getQuoteFeed();
	})(jQuery);
</script>

  

	<div id="content" class="inner">


    <article class="post">
	<h1 class="title"><a href="/blog/how-to-create-reminder-to-iphone-from-mac">Create reminder to your iOS device from Mac</a></h1>
	<div class="entry-content">
		<h1>Update</h1>

<p>If you already upgraded to Moutain Lion OSX, you definetly don&#8217;t need this, there is a navtive Reminder app built in :)</p>

<h1>Original Post</h1>

<p>You need to install <a href="http://www.alfredapp.com/]%20and%20buy%20the%20[http://www.alfredapp.com/purchase/">Powerpack</a>.</p>

<p>You can download Alfred extension here: <a href="http://www.dirtdon.com/?p=1261">http://www.dirtdon.com/?p=1261</a></p>

<p>Then launch your alfred, and type <code>r foo, bar</code> to create the reminder.
You can get the notification of Growl after it&#8217;s done.</p>

<p><img src="http://www.dirtdon.com/wp-content/uploads/2011/10/Screen-Shot-2011-10-31-at-11.26.50-AM.png" title="Create iOS 5 Reminders Tasks from Alfred" ></p>

<h1>日本語</h1>

<h2>前提</h2>

<p><a href="http://www.alfredapp.com/">Alfred</a>およびその<a href="http://www.alfredapp.com/purchase/">Powerpack</a>のインストールが必要になります。</p>

<h2>方法</h2>

<p><a href="http://www.dirtdon.com/?p=1261">http://www.dirtdon.com/?p=1261</a>でAlfred用のExtensionをダウンロードしインストールします。</p>

<p>そうしますと、Alfred呼び出して<code>r hogehoge</code>でリマインダーが作成できます。</p>

<p>作成完了後はGrowlで通知もしてくれますー</p>

<h2>Alfredについて</h2>

<p>超オススメです。試してみてくださいー　特にPowerpack購入後は一気にパワーアップですよ！</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-12-16T00:00:00+09:00" pubdate data-updated="true">2011-12-16</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/mac/'>Mac</a>, <a class='category' href='/blog/categories/alfred/'>alfred</a>, <a class='category' href='/blog/categories/iphone/'>iPhone</a>, <a class='category' href='/blog/categories/ios5/'>ios5</a>, <a class='category' href='/blog/categories/reminder/'>reminder</a>


</div>
	
</div></article>


    <article class="post">
	<h1 class="title"><a href="/blog/ruby-url-encode">Ruby how to encode url</a></h1>
	<div class="entry-content">
		<div><script src='https://gist.github.com/1445867.js'></script>
<noscript><pre><code>&lt;html&gt;&lt;body&gt;You are being &lt;a href=&quot;https://github.com/gist/1445867&quot;&gt;redirected&lt;/a&gt;.&lt;/body&gt;&lt;/html&gt;</code></pre></noscript></div>


		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-12-08T00:00:00+09:00" pubdate data-updated="true">2011-12-08</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/ruby/'>Ruby</a>, <a class='category' href='/blog/categories/urlencode/'>urlencode</a>


</div>
	
</div></article>


    <article class="post">
	<h1 class="title"><a href="/blog/rails-append-class-if-condition-is-true-in-haml">Rails Append class if condition is true in Haml</a></h1>
	<div class="entry-content">
		<div class='embed tweet'><blockquote class="twitter-tweet" lang="ja"><p>Append class if condition is true in Haml (with Rails) - Stack Overflow <a href="http://t.co/7pyL7pNn" title="http://stackoverflow.com/questions/3453560/append-class-if-condition-is-true-in-haml-with-rails">stackoverflow.com/questions/3453…</a></p>&mdash; kinopyoさん (@fantasyday) <a href="https://twitter.com/fantasyday/status/138923631433625600" data-datetime="2011-11-22T10:15:49+00:00">11月 22, 2011</a></blockquote>
<script src="//platform.twitter.com/widgets.js" charset="utf-8"></script></div>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">.</span><span class="n">post</span><span class="p">{</span> <span class="ss">:class</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="s1">&#39;gray&#39;</span> <span class="k">unless</span> <span class="n">post</span><span class="o">.</span><span class="n">published?</span><span class="p">)</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>HAMLである条件がtrueの時だけあるclassをタグに追加したい場合。</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-11-22T00:00:00+09:00" pubdate data-updated="true">2011-11-22</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/haml/'>haml</a>, <a class='category' href='/blog/categories/rails/'>rails</a>


</div>
	
</div></article>


    <article class="post">
	<h1 class="title"><a href="/blog/jquery-checkbox-checked-event">jQuery checkbox checked event</a></h1>
	<div class="entry-content">
		<p>jQueryでチェックボックスの状態を監視するイベントは<strong>click event</strong>を使う。</p>

<p>チェックされたかを判断するには<code>$("#some_checkbox").is(':checked')</code>がいい。</p>

<p>CoffeeScriptでのサンプルコード：</p>

<div><script src='https://gist.github.com/1385217.js'></script>
<noscript><pre><code>&lt;html&gt;&lt;body&gt;You are being &lt;a href=&quot;https://github.com/gist/1385217&quot;&gt;redirected&lt;/a&gt;.&lt;/body&gt;&lt;/html&gt;</code></pre></noscript></div>


<p><strong>change event</strong>も監視はできるが、取れる値は遅延されるみたいです。</p>

<blockquote><p>The change event is sent to an element when its value changes. This event is limited to input elements, textarea boxes and select elements. For select boxes, checkboxes, and radio buttons, the event is fired immediately when the user makes a selection with the mouse, but for the other element types the event is deferred until the element loses focus.</p></blockquote>


<p>参考：<a href="http://forum.jquery.com/topic/jquery-checkbox-checked-event">http://forum.jquery.com/topic/jquery-checkbox-checked-event</a></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-11-22T00:00:00+09:00" pubdate data-updated="true">2011-11-22</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/checkbox/'>checkbox</a>, <a class='category' href='/blog/categories/jquery/'>jQuery</a>


</div>
	
</div></article>


    <article class="post">
	<h1 class="title"><a href="/blog/how-to-disable-tweet-item-in-right-click-menu">Mac Tweetアプリインストール後右クリックメニューの「Tweet」を消す方法</a></h1>
	<div class="entry-content">
		<p>MacのTweet公式アプリをインストール後、テキストを選択状態で右クリックするとメニューに「Tweet」が出てきますね。個人的には使わないのでそれを消す方法をシェアします。</p>

<p><img src="http://www.kinopyo.com/wp-content/uploads/2011/11/Tweet-in-right-click-menu.jpg" title="Tweet in right click menu" ></p>

<p>これはOS Xの<em>Services</em>として登録されます。どのServicesをON/OFFにするかはSystem PreferencesのKeyboardで設定できます。今回の話だと<em>File and Folders</em>で<em>Tweet</em>のチェックボックスを外せばOKです。</p>

<p><img src="http://www.kinopyo.com/wp-content/uploads/2011/11/uncheck-tweet-services.jpg" title="uncheck tweet services" ></p>

<p>UPDATE:
<em>Open as Twitter Username</em>も消すべきでした。</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-11-18T00:00:00+09:00" pubdate data-updated="true">2011-11-18</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/mac/'>Mac</a>, <a class='category' href='/blog/categories/osx/'>osx</a>, <a class='category' href='/blog/categories/twitter/'>twitter</a>


</div>
	
</div></article>


    <article class="post">
	<h1 class="title"><a href="/blog/search-for-rakuten-amazon-yahoo">楽天、アマゾン、Yahooなどを一括検索できるサイト</a></h1>
	<div class="entry-content">
		<p>使ったことはないけど、とりあえずリストアップ。</p>

<ul>
<li><a href="http://all-search.biz/index.php">http://all-search.biz/index.php</a></li>
<li><a href="http://www.tsukaerusite.com/">http://www.tsukaerusite.com/</a></li>
<li><a href="http://www.shopping-tool.com/">http://www.shopping-tool.com/</a></li>
<li><a href="http://aucfan.com/">http://aucfan.com/</a></li>
<li><a href="http://psearch.yahoo.co.jp/search/advanced">http://psearch.yahoo.co.jp/search/advanced</a></li>
</ul>


		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-11-14T00:00:00+09:00" pubdate data-updated="true">2011-11-14</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/amazon/'>amazon</a>, <a class='category' href='/blog/categories/diary/'>diary</a>, <a class='category' href='/blog/categories/rakuten/'>rakuten</a>, <a class='category' href='/blog/categories/yahoo/'>yahoo</a>


</div>
	
</div></article>


    <article class="post">
	<h1 class="title"><a href="/blog/mail-to-delicious-to-bookmart-a-page">d.me メール送るだけでDeliciousにブックマークできるようになった</a></h1>
	<div class="entry-content">
		<div class='embed tweet'><blockquote class="twitter-tweet" lang="ja"><p>d.me メール送るだけでDeliciousにブックマークできるようになった<a href="http://t.co/9xoR5Yp8" title="http://www.avos.com/as-easy-as-d-me/">avos.com/as-easy-as-d-m…</a></p>&mdash; kinopyoさん (@fantasyday) <a href="https://twitter.com/fantasyday/status/135953105501175811" data-datetime="2011-11-14T05:32:00+00:00">11月 14, 2011</a></blockquote>
<script src="//platform.twitter.com/widgets.js" charset="utf-8"></script></div>


		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-11-14T00:00:00+09:00" pubdate data-updated="true">2011-11-14</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/delicious/'>delicious</a>, <a class='category' href='/blog/categories/webservice/'>webservice</a>


</div>
	
</div></article>


    <article class="post">
	<h1 class="title"><a href="/blog/get-twitter-post-url">TwitterつぶやきのURLを取得する方法</a></h1>
	<div class="entry-content">
		<p>ポイントは<em>2 hours ago</em>のような時間のリンクをクリックすること。マウスオーバーしないとリンクのように見えないですが。。</p>

<p><img src="http://www.kinopyo.com/wp-content/uploads/2011/11/Twitter-status-link-1.jpg" title="Twitter status link" ></p>

<p><img src="http://www.kinopyo.com/wp-content/uploads/2011/11/twitter-individual-status-url-1.jpg" title="twitter individual status url-1" ></p>

<p>参考：<a href="http://www.askdavetaylor.com/how_to_figure_out_individual_twitter_status_url_tweet_twhirl.html">http://www.askdavetaylor.com/how_to_figure_out_individual_twitter_status_url_tweet_twhirl.html</a></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-11-14T00:00:00+09:00" pubdate data-updated="true">2011-11-14</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/tips/'>Tips</a>, <a class='category' href='/blog/categories/twitter/'>Twitter</a>, <a class='category' href='/blog/categories/twitter/'>twitter</a>


</div>
	
</div></article>


    <article class="post">
	<h1 class="title"><a href="/blog/sakura-vps-centos-performance-tunning-wordpress">さくらVPSのパフォーマンスチューニング</a></h1>
	<div class="entry-content">
		<p>さくらVPSでWordpressブログをやってます。そんなにアクセスがないはずなのに、さくらVPSに移行した当時は結構サーバが落ちました。topコマンドで見るとスワップが結構70%まで上がったりして、手動でapache再起動とかもやりました。。ネットでいろいろググッてそれなりにパフォーマンスチューニングした結果やっと安定して、同じサーバに2つのWordpressブログと一つのRailsアプリケーションを実行しています。</p>

<p>参考までにさくらVPSは一番安いの512MB、月1000円のプランで、平日だとこのブログの一日PVは大体500〜600です。</p>

<p>チューニングしてから結構時間が経ったのでだいぶ忘れました。Evernoteでのメモを貼ります。</p>

<p>効果が高い順で。</p>

<h2>Wordpress</h2>

<p><strong>W3 Total Cache</strong>プラグインが一押しです。インストールも設定も簡単ですし、一番効果があります。
ページのキャッシュ、cssやjavascriptのマージと圧縮など、結構やってくれます。実際これだけ入れても感じるほど早くなるはずです。</p>

<h2>Apache</h2>

<p><code>httpd.conf</code>を編集します。いろいろ修正してみましたが、結果下記の設定にしました。この辺はググったら結構出ますが、それぞれの環境に合わせて試行錯誤したほうがオススメです。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;IfModule prefork.c>
</span><span class='line'>StartServers       5
</span><span class='line'>MinSpareServers    5
</span><span class='line'>MaxSpareServers   10
</span><span class='line'>ServerLimit      64
</span><span class='line'>MaxClients       64
</span><span class='line'>MaxRequestsPerChild  50
</span><span class='line'>MaxMemFree 2000
</span><span class='line'>&lt;/IfModule></span></code></pre></td></tr></table></div></figure>


<h2>PHP</h2>

<h3>/etc/php.ini</h3>

<p>zlib.output_compression = On</p>

<h3>APC</h3>

<p>pecl install APC</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-11-11T00:00:00+09:00" pubdate data-updated="true">2011-11-11</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/apache/'>Apache</a>, <a class='category' href='/blog/categories/php/'>PHP</a>, <a class='category' href='/blog/categories/performance/'>Performance</a>, <a class='category' href='/blog/categories/wordpress/'>WordPress</a>, <a class='category' href='/blog/categories/centos/'>centos</a>


</div>
	
</div></article>


    <article class="post">
	<h1 class="title"><a href="/blog/rails-using-asset-hosts">Rails asset hostsについて</a></h1>
	<div class="entry-content">
		<p><a href="http://api.rubyonrails.org/classes/ActionView/Helpers/AssetTagHelper.html">ActionView/Helpers/AssetTagHelper</a>、asset(画像、CSSなど)ホストのチューニングについての勉強メモです。</p>

<h2>asset hostを指定</h2>

<p>image_tag(&#8220;rails.png&#8221;)のhelper methodで生成するリンクはデフォルトでは同じホストのpublicフォルダを指しています。それを変更したい場合は<code>config/environments/production.rb</code>の<code>ActionController::Base.asset_host</code>をいじります。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="ss">ActionController</span><span class="p">:</span><span class="ss">:Base</span><span class="o">.</span><span class="n">asset_host</span> <span class="o">=</span> <span class="s2">&quot;assets.example.com&quot;</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='erb'><span class='line'><span class="x">image_tag(&quot;rails.png&quot;)</span>
</span><span class='line'><span class="x"># =&gt; &lt;img alt=&quot;Rails&quot; src=&quot;http://assets.example.com/images/rails.png?1230601161&quot; /&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h2>asset hostを複数指定</h2>

<p>ブラウザが一度に同一サーバには２つのコネクションしかできないそう（これは初めて知りました）で、asset同士のダウンロード完了するのを待たなければなりません。もし複数台のassetサーバがある場合は<code>assets%d.example.com</code>を使ってそれをコネクション数を増やせることができます。<code>%d</code>が指定されればRailsは0~3の４つの番号を付けて、並行して８つのコネクションができます。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="ss">ActionController</span><span class="p">:</span><span class="ss">:Base</span><span class="o">.</span><span class="n">asset_host</span> <span class="o">=</span> <span class="s2">&quot;assets%d.example.com&quot;</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='erb'><span class='line'><span class="x">image_tag(&quot;rails.png&quot;)</span>
</span><span class='line'><span class="x"># =&gt; &lt;img alt=&quot;Rails&quot; src=&quot;http://assets.example.com/images/rails.png?1230601161&quot; /&gt;</span>
</span><span class='line'><span class="x">stylesheet_link_tag(&quot;application&quot;)</span>
</span><span class='line'><span class="x"># =&gt; &lt;link href=&quot;http://assets2.example.com/stylesheets/application.css?1232285206&quot; media=&quot;screen&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; /&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h2>カスタマイズ</h2>

<p>もっと自分でカスタマイズしたい場合は<code>source</code>のprocパラメータを使えます。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="ss">ActionController</span><span class="p">:</span><span class="ss">:Base</span><span class="o">.</span><span class="n">asset_host</span> <span class="o">=</span> <span class="no">Proc</span><span class="o">.</span><span class="n">new</span> <span class="p">{</span> <span class="o">|</span><span class="n">source</span><span class="o">|</span>
</span><span class='line'>  <span class="s2">&quot;http://assets</span><span class="si">#{</span><span class="ss">Digest</span><span class="p">:</span><span class="ss">:MD5</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">(</span><span class="n">source</span><span class="p">)</span><span class="o">.</span><span class="n">to_i</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="si">}</span><span class="s2">.example.com&quot;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="n">image_tag</span><span class="p">(</span><span class="s2">&quot;rails.png&quot;</span><span class="p">)</span>
</span><span class='line'><span class="c1"># =&gt; &lt;img alt=&quot;Rails&quot; src=&quot;http://assets1.example.com/images/rails.png?1230601161&quot; /&gt;</span>
</span><span class='line'><span class="n">stylesheet_link_tag</span><span class="p">(</span><span class="s2">&quot;application&quot;</span><span class="p">)</span>
</span><span class='line'><span class="c1"># =&gt; &lt;link href=&quot;http://assets2.example.com/stylesheets/application.css?1232285206&quot; media=&quot;screen&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; /&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>特定のパスで始まるassetを特定のホストに指定する例：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="ss">ActionController</span><span class="p">:</span><span class="ss">:Base</span><span class="o">.</span><span class="n">asset_host</span> <span class="o">=</span> <span class="no">Proc</span><span class="o">.</span><span class="n">new</span> <span class="p">{</span> <span class="o">|</span><span class="n">source</span><span class="o">|</span>
</span><span class='line'>   <span class="k">if</span> <span class="n">source</span><span class="o">.</span><span class="n">starts_with?</span><span class="p">(</span><span class="s1">&#39;/images&#39;</span><span class="p">)</span>
</span><span class='line'>     <span class="s2">&quot;http://images.example.com&quot;</span>
</span><span class='line'>   <span class="k">else</span>
</span><span class='line'>     <span class="s2">&quot;http://assets.example.com&quot;</span>
</span><span class='line'>   <span class="k">end</span>
</span><span class='line'> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='erb'><span class='line'><span class="x">image_tag(&quot;rails.png&quot;)</span>
</span><span class='line'><span class="x"># =&gt; &lt;img alt=&quot;Rails&quot; src=&quot;http://images.example.com/images/rails.png?1230601161&quot; /&gt;</span>
</span><span class='line'><span class="x">stylesheet_link_tag(&quot;application&quot;)</span>
</span><span class='line'><span class="x"># =&gt; &lt;link href=&quot;http://assets.example.com/stylesheets/application.css?1232285206&quot; media=&quot;screen&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; /&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>さらに<code>request</code>の第二パラメータもあります。これでHTTPSの動作も制御できます。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="ss">ActionController</span><span class="p">:</span><span class="ss">:Base</span><span class="o">.</span><span class="n">asset_host</span> <span class="o">=</span> <span class="no">Proc</span><span class="o">.</span><span class="n">new</span> <span class="p">{</span> <span class="o">|</span><span class="n">source</span><span class="p">,</span> <span class="n">request</span><span class="o">|</span>
</span><span class='line'>  <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">ssl?</span>
</span><span class='line'>    <span class="s2">&quot;</span><span class="si">#{</span><span class="n">request</span><span class="o">.</span><span class="n">protocol</span><span class="si">}#{</span><span class="n">request</span><span class="o">.</span><span class="n">host_with_port</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>  <span class="k">else</span>
</span><span class='line'>    <span class="s2">&quot;</span><span class="si">#{</span><span class="n">request</span><span class="o">.</span><span class="n">protocol</span><span class="si">}</span><span class="s2">assets.example.com&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Resources</h2>

<p>http://api.rubyonrails.org/classes/ActionView/Helpers/AssetTagHelper.html</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-11-09T00:00:00+09:00" pubdate data-updated="true">2011-11-09</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/ruby/'>Ruby</a>, <a class='category' href='/blog/categories/asset/'>asset</a>, <a class='category' href='/blog/categories/rails/'>rails</a>


</div>
	
</div></article>

<nav id="pagenavi">
    
        <a href="/blog/page/8/" class="prev">Prev</a>
    
    
        <a href="/blog/page/10/" class="next">Next</a>
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav></div>
	<footer id="footer" class="inner">Copyright &copy; 2014

    Qihuan Piao

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'kinopyoblog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-33226278-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>



</body>
</html>