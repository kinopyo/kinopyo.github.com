<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: factory_girl | Yet Another Kinopyo Blog]]></title>
  <link href="http://kinopyo.github.com/blog/categories/factory-girl/atom.xml" rel="self"/>
  <link href="http://kinopyo.github.com/"/>
  <updated>2012-08-29T01:53:12+09:00</updated>
  <id>http://kinopyo.github.com/</id>
  <author>
    <name><![CDATA[Qihuan Piao]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[FactoryGirl: How to define a value based on an already defined one]]></title>
    <link href="http://kinopyo.github.com/blog/factorygirl-how-to-define-a-value-based-on-an-already-defined-one"/>
    <updated>2012-01-26T00:00:00+09:00</updated>
    <id>http://kinopyo.github.com/blog/factorygirl-%e6%97%a2%e3%81%ab%e5%ae%9a%e7%be%a9%e3%81%97%e3%81%9f%e5%80%a4%e3%82%92%e3%83%99%e3%83%bc%e3%82%b9%e3%81%ab%e3%81%97%e3%81%9f%e5%80%a4%e3%82%92%e8%a8%ad%e5%ae%9a%e3%81%99%e3%82%8b</id>
    <content type="html"><![CDATA[<p>FactoryGirlで既に定義した値を使おうとする時の方法です。
例えばLessonというクラスのstart_atとend_atの属性があり、start_atを定義した後はend_atをその2時間後に定義したい場合、ブロックでパラメータを渡せばそこでstart_atにアクセスできるようになります。</p>

<p><div><script src='https://gist.github.com/1680766.js?file='></script>
<noscript><pre><code># Say you have two columns: start_at, end_at
# When start_at is defined, you want end_at's value based on the start_at
# Here is the solution, passing a block to get the object of the context.

start_at Random.new.rand(14..45).days.from_now
end_at { |l| l.start_at + 2.hours }

# Full example
FactoryGirl.define do
  factory :lesson do
    sequence(:title) { |n| &quot;lesson title#{n}&quot; }
    sequence(:description) { |n| &quot;lesson description#{n}&quot; }
    capacity 6
    start_at Random.new.rand(14..45).days.from_now
    end_at { |l| l.start_at + 2.hours }
    price [5000, 5100, 5200, 5300, 5500, 6000].sample
  end
end</code></pre></noscript></div>
</p>
]]></content>
  </entry>
  
</feed>
