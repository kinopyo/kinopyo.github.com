<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Facebook | Yet Another Kinopyo Blog]]></title>
  <link href="http://kinopyo.com/blog/categories/facebook/atom.xml" rel="self"/>
  <link href="http://kinopyo.com/"/>
  <updated>2012-08-31T22:50:41+09:00</updated>
  <id>http://kinopyo.com/</id>
  <author>
    <name><![CDATA[Qihuan Piao]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[What you can do with Facebook Comments Social Plugin]]></title>
    <link href="http://kinopyo.com/blog/what-you-can-do-with-facebook-comments-social-plugin"/>
    <updated>2012-01-05T00:00:00+09:00</updated>
    <id>http://kinopyo.com/blog/english-what-you-can-do-with-facebook-comments-social-plugin</id>
    <content type="html"><![CDATA[<h1>Goal</h1>

<p>To use facebook comments integrated to your own site.</p>

<h2>Requirements</h2>

<p>Need a facebook application for your site(domain).</p>

<p>For example:</p>

<p><img src="http://www.kinopyo.com/wp-content/uploads/2012/01/Screen-Shot-2012-01-05-at-14.21.25.png"></p>

<h2>How to get it</h2>

<p>Fill in the blank and click get code from <a href="https://developers.facebook.com/docs/reference/plugins/comments/">https://developers.facebook.com/docs/reference/plugins/comments/</a></p>

<p>Then just paste that code to your site(page).</p>

<h2>Functions</h2>

<ul>
<li><p>People who want to comment can choose if post to Facebook, there's a checkbox.</p></li>
<li><p>Comments posted to facebook are bidirectional. Threads stay synced across Facebook and on the Comments Box on your site regardless of where the comment was made.</p></li>
<li><p>Sort comments by Social Ranking, Chronological(Time) order</p></li>
<li><p>Boosting comments: Moderators can now ensure that high-quality comments appear at the top of the Comments Box</p></li>
</ul>


<p>&nbsp;</p>

<p>Facebook doesn't explain how the Social Ranking works, but I checked some real-world examples and I guess basically we can consider it sort by like counts.</p>

<h2>Moderation Tools</h2>

<p>Put this meta tag in the html.</p>

<p><span style="color: #008080;"> &lt;meta property="fb:admins" content="{YOUR_FACEBOOK_USER_ID}"/&gt;</span></p>

<p>Then if you log in with the owner of the application, you can access this url to control comments:</p>

<p><a href="http://developers.facebook.com/tools/comments">http://developers.facebook.com/tools/comments</a></p>

<p>or you can do it inside the Comments Box directly.</p>

<p>There're Moderate dropdown to Hide comment, Ban User or Boost comment. In the Settings page you have other options like add moderators or set blacklisted words, etc.</p>

<p>Remember to check all the FAQ on the reference docs, very useful. I wonder why those go to the FAQ though.</p>

<h1>Reference</h1>

<p><a href="https://developers.facebook.com/docs/reference/plugins/comments/">https://developers.facebook.com/docs/reference/plugins/comments/</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[FacebookとHeroku]]></title>
    <link href="http://kinopyo.com/blog/facebook-and-heroku"/>
    <updated>2011-09-21T00:00:00+09:00</updated>
    <id>http://kinopyo.com/blog/facebook-and-heroku</id>
    <content type="html"><![CDATA[<p>これはいいコンビの結成ですね。Heroku上で簡単にFacebookアプリが開発できるようになったそうです。言語も選択できるし、Herokuに慣れた人にとっては大変便利なツールだと思います。</p>

<p><a href="http://blog.heroku.com/archives/2011/9/15/facebook/">http://blog.heroku.com/archives/2011/9/15/facebook/</a></p>

<iframe src="http://player.vimeo.com/video/29082940?title=0&amp;byline=0&amp;portrait=0" width="400" height="265" frameborder="0" webkitAllowFullScreen allowFullScreen></iframe>


<p><a href="http://vimeo.com/29082940">Facebook/Heroku integration</a> from <a href="http://vimeo.com/heroku">heroku</a> on <a href="http://vimeo.com">Vimeo</a>.</p>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[複数URLのFacebookいいね(Like)された数を取得する方法]]></title>
    <link href="http://kinopyo.com/blog/how-to-get-facebook-like-counts-for-multiple-urls"/>
    <updated>2011-07-20T00:00:00+09:00</updated>
    <id>http://kinopyo.com/blog/how-to-get-facebook-like-counts-for-multiple-urls</id>
    <content type="html"><![CDATA[<p>今はほとんどのサイトがLike(いいね！)ボタンを置いてますが、Likeボタンがどれだけクリックされたか、その数は気になりますね。</p>

<p>Facebook独自のFQL（文法はSQLに似ている）を使って複数URLのLikeされた数が取れます。Facebook公式ドキュメントは<a href="http://developers.facebook.com/docs/reference/fql/link_stat/">こちら</a>にあります。</p>

<p>下記はPHPでのサンプルコードです。
<div><script src='https://gist.github.com/1073555.js?file=get_facebook_like_counts_of_multiple_urls.php'></script>
<noscript><pre><code>&lt;?php
// see fql docs:
// http://developers.facebook.com/docs/reference/fql/link_stat/

$url_list = array(
	'http://example.com/url1.html',
	'http://example.com/url2.html',
);

$url_string = '(&quot;'. implode('&quot;,&quot;', $url_list). '&quot;)';

// just like sql syntax
$fql = &quot;select url, like_count from link_stat where url in&quot;.$url_string;
// remember to encode it
$url = &quot;https://api.facebook.com/method/fql.query?format=json&amp;query=&quot;.urlencode($fql);

$ch = curl_init($url);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
$data = curl_exec($ch);
curl_close($ch);

$json = json_decode($data, true);
$ret = array();
print_r($json);

// result example
/*
Array
(
    [0] =&gt; Array
        (
            [url] =&gt; http://example.com/url1.html
            [like_count] =&gt; 10
        )

    [1] =&gt; Array
        (
            [url] =&gt; http://example.com/url2.html
            [like_count] =&gt; 20
        )

)
*/</code></pre></noscript></div>
</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Facebookからのメール：you may be allowing authentication data to be passed to 3rd parties]]></title>
    <link href="http://kinopyo.com/blog/mail-from-facebook-you-may-be-allowing-authentication-data-to-be-passed-to-3rd-parties"/>
    <updated>2011-05-20T00:00:00+09:00</updated>
    <id>http://kinopyo.com/blog/mail-from-facebook-you-may-be-allowing-authentication-data-to-be-passed-to-3rd-parties</id>
    <content type="html"><![CDATA[<p>Our automated systems have detected that you may be inadvertently allowing authentication data to be passed to 3rd parties.</p>

<p>ここ最近Facebookから”認証情報をサードパーティに渡している可能性がある、48時間内に修正しろ”みたいなメールが届いた人が多いと思います。
メール本文です：</p>

<blockquote>
Dear Developer of xxxxxx {your app name} xxxxx,

Our automated systems have detected that you may be inadvertently allowing authentication data to be passed to 3rd parties. Allowing user ids and access tokens to be passed to 3rd parties, even inadvertently, could allow these 3rd parties to access the data the user made available to your site. This violates our policies and undermines user trust in your site and Facebook Platform.

In every case that we have examined, this information is passed via the HTTP Referer Header by the user’s browser. This can happen when using our legacy authentication system and including &lt;iframe&gt;, &lt;img&gt; or &lt;script&gt; content from 3rd parties in the page that receives authentication data from Facebook. Our legacy mechanism passes authentication information in the URL query string which, if handled incorrectly, can be passed to 3rd parties by the browser. Our current OAuth 2.0 authentication system, released over a year ago, passes this information in the URL fragment, which is not passed to 3rd parties by the browser.

Please ensure that you are not allowing this data to be passed immediately. Accessing your site as a test user while running a HTTP proxy/monitor like Charles or Fiddler is the best way to determine if you are allowing this information to be passed. If you discover the issue, you can do one of two things:

1. Migrate your site to use our OAuth 2.0 authentication system. We are requiring all apps and sites to update to this mechanism by Sept. 1, 2011. Migrating now will address this issue and ensure that you are one of the first to meet the deadline. For more details, please see our Authentication Guide.

2. Create and use an interstitial page to remove the authentication data before redirecting to your page with 3rd party content. This approach is used by many of our largest developers today (although they are all migrating to OAuth 2.0 shortly). This is a simple and straightforwardchange that should have minimal impact on your site. For more details on this approach, see our Legacy Connect Auth doc.

Because of the importance of ensuring user trust and privacy, we are asking you to complete one of the above steps in the next 48 hours. If you fail to do so, your site may be subject to one of the enforcement actions outlined in our policies.

If you have any questions or believe you have received this message in error, please contact us.

Facebook Developer Relations
</blockquote>


<p>多分認証システムが古い（OAuth 2.0を使ってない）かつ、該当のページに&lt;iframe&gt;などのタグがあるのを条件としてFacebook側が検知してたと思います、別にサードパーティにどうこうした訳ではなく。</p>

<h2>ソースの確認</h2>

<p>まずユーザ認証のところのソースを確認しましょう。
古い認証システムを使う場合これに似てるはずです。
ソースはFacebookの<a href="http://developers.facebook.com/docs/authentication/connect_auth/">http://developers.facebook.com/docs/authentication/connect_auth/</a>より。</p>

<p>```php
 $api_key = "YOUR_API_KEY";
 $interstitial_page = "YOUR_SECURE_URL"; //URL with no 3rd party apps</p>

<p> $url='http://www.facebook.com/login.php?api_key=' . $app_id
   . '&amp;session_version=3&amp;next=' . urlencode($interstitial_page)
   . '&amp;v=1.0&amp;return_session=1&amp;fbconnect=1'
   . '&amp;cancel_url=' . urlencode($interstitial_page);</p>

<p> echo "Welcome to the Old Auth flow";
 echo "<p>";</p>

<p> echo("<a href='" . $url . "'>"
   . "<img src='http://static.ak.facebook.com/images/"
   . "devsite/facebook_login.gif'></a>");</p>

<p>```</p>

<p>この場合nextパラメータで指定したページに行く時、URLパラメータでuidとかaccess_tokenが渡されますので、危ないと。</p>

<p><a href="http://developers.facebook.com/attachment/request_img.png"><img alt="" src="http://developers.facebook.com/attachment/request_img.png" title="古い認証システムでは情報をパラメータ文字列で返す" class="alignnone" width="480" height="100" /></a></p>

<p>OAuth 2.0を使ったログインURLはこうです。</p>

<p>```plain
https://www.facebook.com/dialog/oauth?client_id=YOUR_APP_ID&amp;redirect_uri=YOUR_URL&amp;scope=email,read_stream</p>

<p>```</p>

<h2>改修</h2>

<p>メールで書かれた通り一つはOAuth2.0に移行する、一つは「中間ページ」挟んでユーザ情報をセッションに保持して隠蔽する。</p>

<p>OAuthについては<a href="https://developers.facebook.com/docs/authentication/">https://developers.facebook.com/docs/authentication/</a>で詳しく説明しています。</p>

<p>後者の場合は<a href="http://developers.facebook.com/docs/authentication/connect_auth/">http://developers.facebook.com/docs/authentication/connect_auth/</a>の最後でサンプルコードがあるので参考できます。</p>
]]></content>
  </entry>
  
</feed>
