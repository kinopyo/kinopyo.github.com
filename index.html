
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Kinopyo Blog</title>
	<meta name="author" content="Qihuan Piao">

	
	<meta name="description" content="舘鼻則孝さんの講演を聞いて LADY GAGAの靴を作る若きデザイナーとして名を知られた舘鼻則孝さんが今日うちの会社で講演があった。
「黙々とものづくりを一人で楽しむよりも、それを発信したい、共有したい」という気持ちを強く感じた。トークの内容自体はもちろん良い刺激になったが、 &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="http://feeds.feedburner.com/kinopyo" rel="alternate" title="Kinopyo Blog" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
</head>

<body>
	<header id="header" class="inner"><h1><a href="/">Kinopyo Blog</a></h1>
<nav id="main-nav"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
  <li><a href="http://about.me/kinopyo">About</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
  <li><a href="http://about.me/kinopyo">About</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:kinopyo.com">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		
		<a class="twitter" href="http://twitter.com/fantasyday" title="Twitter">Twitter</a>
		
		
		<a class="github" href="https://github.com/kinopyo" title="GitHub">GitHub</a>
		
		
		
		
		
		<a class="rss" href="http://feeds.feedburner.com/kinopyo" title="RSS">RSS</a>
		
	</div>
	<form class="search" action="http://google.com/search" method="get" id="search_form">
		<input class="alignright" type="text" name="g" results="0">
		<input type="hidden" name="q" value="site:kinopyo.com">
	</form>
</nav>

</header>
  
    <header id='about_me' class="inner">
      <div class="photo">
        <img src="http://cdn.kinopyo.com/images/profile.jpg" alt="Photo - Qihuan Piao">
      </div>
      <h3>Hi I'm Qihuan Piao, I'm a Rails developer and I like to make stuff.</h3>
      <p>
        Here I share articles and tips about web development, inpirations and thoughts I get from books and daily life.
      </p>
      <p>I believe that English is a <strong>MUST</strong> skill for me to become a great engineer, so I’m trying to to write posts in it these days.</p>
    </header>

  

	<div id="content" class="inner">


    <article class="post">
	<h1 class="title"><a href="/blog/craft-and-voice/">ものづくりと発信力</a></h1>
	<div class="entry-content">
		<h2 class="lead">舘鼻則孝さんの講演を聞いて</h2>


<p>LADY GAGAの靴を作る若きデザイナーとして名を知られた舘鼻則孝さんが今日うちの会社で講演があった。
「黙々とものづくりを一人で楽しむよりも、それを発信したい、共有したい」という気持ちを強く感じた。トークの内容自体はもちろん良い刺激になったが、外国人である自分にとってそれ以上に感じたのは舘鼻則孝さんの講演のナチュナルさとボキャブラリーの豊富さだった。</p>

<p><img src="http://cdn.kinopyo.com/images/noritaka.jpg" alt="舘鼻則孝がデザインした靴" /></p>

<p>日本に来て8年目、日本語がネイテイブレベルになっても全然おかしくないくらいの年月が経った。しかし本当に上達してたのは来日最初の2年くらいで、その後はずっと停滞状態。身の回りの日本語は基本ビジネスや仕事のコンテキストで、読書もプログラミングや理系寄りの本ばっかりで偏りが強かった。特にここ二年間は完全に英語の環境に置かれ（自分の意思で）、日本語で何かを深くディスカッション
するようなチャンスはなかなかなかった。</p>

<p>でも今日の講演を聞いた時はまるで自分のネイティブの言語で話された時となぜか同レベルでの親しみと共感があった。舘鼻則孝さんの本業はもちろん言語のマスターではないが、タイミングよくピックアップされた単語があまりにも正確すぎて、表現したい内容がとても伝わってきた。新鮮で斬新で的確、昔の文豪のようにパット理解しきれいないほどの言葉を並ばなくても、十分人の心に響くことができるんだ、と思った。</p>

<p>鼻則孝さん本人は作品と裏付けてる文化をより多くの人に発信したいため、普段からコミュニケーションを重視しているそうだ。それに比べ僕は多くの場合人との会話を避けたがる癖があるし、いいものを作れば勝手に評価される、そうなるべきと心のどっかで思ってる。今は情報溢れの時代であり、凄腕を持ってる人は少なくない、このノイジーな世の中でいかに自分の思想なり作品なりを発信するかは、普段から意識してないとそこで成長は止まる。</p>

<blockquote><p>I don&#8217;t think writers are sacred, but words are. They deserve respect. If you get the right ones in the right order, you might nudge the world a little or make a poem that children will speak for you when you are dead.</p>

<p>― Tom Stoppard, The Real Thing: A Play</p></blockquote>

<p>この言葉が最近結構気に入ってて、「正しい単語を正しい順番に並べば世界をちょっとだけ変えたり、詩でも作ったら死後は子供が永遠にあなたの作品を詠みつづけるだろう」(あまりよく訳してないところはご理解していただきたい。。)</p>

<p>自分の主張や考え方をうまく伝えず悔しい思いをしたことは今まで多々ある。コミュニケーションの重要さをあらためて認識させて本当に感謝。技術だけでなく、発信力の引き出しも増やさないと、と強く思った。</p>

<p>下記完全に個人用のまとめ</p>

<ul>
<li>常に発信したい意欲を持つこと</li>
<li>そのためには自分をできれば職場、職業と離れたコンテキストに置くこと</li>
<li>肉ばっかり（理系の本）食べずに野菜（対して文系？）もちゃんと摂取すること</li>
</ul>


<p>各種リンク：</p>

<ul>
<li><a href="http://ja.wikipedia.org/wiki/%E8%88%98%E9%BC%BB%E5%89%87%E5%AD%9D">舘鼻則孝 - Wikipedia</a></li>
<li><a href="http://noritakatatehana.com/">NORITAKA TATEHANA</a></li>
<li><a href="http://ja.wikipedia.org/wiki/%E3%82%B7%E3%83%A5%E3%82%BF%E3%82%A4%E3%83%8A%E3%83%BC%E6%95%99%E8%82%B2">シュタイナー教育 - Wikipedia</a></li>
<li><a href="https://www.google.co.jp/search?q=%E8%88%98%E9%BC%BB%E5%89%87%E5%AD%9D&amp;es_sm=91&amp;source=lnms&amp;tbm=isch&amp;sa=X&amp;ei=MVk2Ve6xJeXVmgWW94DACg&amp;ved=0CAcQ_AUoAQ&amp;biw=1366&amp;bih=669#tbm=isch&amp;q=%E8%88%98%E9%BC%BB%E5%89%87%E5%AD%9D+Lady+gaga">舘鼻則孝 Lady gaga - Google Search</a></li>
</ul>


<p>今まで聞いた講演や読んだ本の中で言葉遣いで一番共感を得たのは？ぜひコメントで教えてください！</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-04-21T13:02:00+09:00" pubdate data-updated="true">2015-04-21</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/雑談/'>雑談</a>


</div>
	
</div>
</article>


    <article class="post">
	<h1 class="title"><a href="/blog/reading-materials-for-oocss/">Reading Materials For OOCSS, BEM And SMACSS</a></h1>
	<div class="entry-content">
		<p>After all these years of web development I still haven&#8217;t found a compelling way to organize and name css, once we all seemed to agree with the semantic naming methodology but as the project grows the magic aura disappears.</p>

<p>Recently my team has started the transition to apply OOCSS, SMACSS and BEM techniques to current project. I tried it a while and really think this is the best way so far to cleanly organize your css(code and files), make it scalable and reusable, with simple intuitive naming methomelodgy.</p>

<h2>Recommendations</h2>

<p>Here are the reading materials I found pretty easy to follow:</p>

<p><a href="https://mattstauffer.co/blog/organizing-css-oocss-smacss-and-bem">Organizing CSS: OOCSS, SMACSS, and BEM - MattStauffer.co</a></p>

<p>High level introduction to each terms, with simple example. Read it and you&#8217;ll get the big picture.</p>

<br>


<p><a href="http://csswizardry.com/2013/01/mindbemding-getting-your-head-round-bem-syntax/">MindBEMding – getting your head ’round BEM syntax – CSS Wizardry – CSS, OOCSS, front-end architecture, performance and more, by Harry Roberts</a></p>

<p>Have an excellent guide on when to use BEM and not.</p>

<br>


<p><a href="http://blog.planetargon.com/entries/2014/1/7/the-pros-and-cons-of-modular-sass">The Pros and Cons of Modular Sass — Planet Argon Blog</a></p>

<p>Great article on the idea behind modular css in general. And the argument over semantic class names convinced me.</p>

<blockquote><p>Semantic markup is important in communicating the meaning of a webpage and is only becoming increasingly important; however, class names are for the developer. The exception to this relates to the use of microformats, in which case it is necessary to use specific semantic class names. It’s always important to consider names and what they communicate to you, your team, and future developers, but there is no dogmatic reason to avoid classes like “grid-1” or “pull-left” just because they describe presentation. People have conflated the use of semantic HTML (which relates to optimizing content for assistive technologies, browsers, the multitude of devices, and software that recontextualizes and reframes your content) with avoiding presentational class names for years, and I’m not quite sure why.</p></blockquote>

<p><a href="http://mikefowler.me/2013/10/17/support-for-bem-modules-sass-3.3/">Support for BEM modules in Sass 3.3 | Mike Fowler</a></p>

<p>How to write BEM in Sass.</p>

<br>


<p><a href="http://fullstackradio.com/episodes/1/">Full Stack Radio - 1: Matt Stauffer - CSS Semantics</a></p>

<p>A podcast. You&#8217;ll get more out of it if you already some idea and experience about these terms, as in the podcast there&#8217;re deep discussions on the very details of daily development.</p>

<br>


<p>That&#8217;s it. Hope this could help you find your starting point.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-04-15T20:16:00+09:00" pubdate data-updated="true">2015-04-15</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/css/'>CSS</a>


</div>
	
</div>
</article>


    <article class="post">
	<h1 class="title"><a href="/blog/my-first-personal-quarterly-off-site/">My First Personal Quarterly Off-site</a></h1>
	<div class="entry-content">
		<h2 class="lead">Get Yourself Back In The Busy World</h2>


<p>I tend to believe I know what I&#8217;m doing, where I&#8217;m going, I&#8217;m in the control of my life, but that&#8217;s not the truth and it&#8217;s really easy to derail from the path you committed to go by living with a demanding work and all sorts of unknown encounters.</p>

<blockquote><p>The most dangerous thought you can have as a creative person is to think you know what you&#8217;re doing. - Alan Key</p></blockquote>

<p><img src="http://cdn.kinopyo.com/images/coffee_and_ipad.jpg" alt="" /></p>

<p>I think I found a good way to organize and regain the control of it.</p>

<h2>Review For Yourself</h2>

<p>If you work on a corporate company you must be familiar with the annual or quarterly performance review and evaluation, often times it&#8217;s mandatory, and it&#8217;s officially scheduled in your and your organization&#8217;s calendar. Process varies but I always feel that&#8217;s not really reflecting myself, that&#8217;s only a tiny part of the professional work, why don&#8217;t I do it for myself not for anyone else, to tru?</p>

<p>So last Friday I took one day off for this &#8220;Personal Quarterly Off-site&#8221;, to review my last 90 days of personal and professional life and set goals and plans for next 90 days. The end result was so great, I got way more than I expected, never thought I could get that much out of myself. Besides the basic concept, I&#8217;ll also share the process and tips I found that works for me.</p>

<h2>What Is Personal Quarterly Off-site</h2>

<p>I heard it from the <a href="http://michaelhyatt.com/season-3-episode-12-the-disciplined-pursuit-of-less-podcast.html">podcast</a>, Greg McKeown the author of the best selling <a href="http://www.amazon.com/dp/0804137382/">Essentialism: The Disciplined Pursuit of Less</a>, which is one of my favorite, introduced his idea of it.</p>

<blockquote><p>Every 90 days, you take a day. You evaluate what you’ve been doing during the last 90 days. You have what I call the most important hour of your life, which is when you go through a set of questions. Then you set your (very few) goals for the next 90 days to make sure you’re in alignment with what you really want to do ultimately with your life. This is it.</p></blockquote>

<h2>Strategy 1: Schedule it</h2>

<p>This is the first step and perhaps the most important step. I didn&#8217;t do it immediately after I heard the idea, even though I felt interesting. I intentionally scheduled it for 1 week later, and told my boss I&#8217;m gonna that day off in advance.</p>

<p>Until that day I chose some of my favorite podcasts, book highlights and  articles to read related to the topic, by consciously telling myself, that day is coming and I&#8217;m gonna do some serious work, I was able to let my brain be prepared subsconciously. It builds up the right mindset in the downtime too. I also shared that schedule to get some peer pressure.</p>

<p>One thing needs to mention, very soon there&#8217;s a deadline in my current project, it wasn&#8217;t easy to bring it up in this season and I did feel somehow guilty about being absent while others working hard to meet the deadline. But let&#8217;s admit there&#8217;s no perfect time you could work less, there&#8217;s always something that needs you to look at, but only you can be responsible for yourself, in professional and personal. So this time I was bold enough to take the chance.</p>

<h2>Strategy 2: Set the Environment Right</h2>

<p>How many notifications do you get every single day? It&#8217;s so easy to &#8220;connect&#8221; to something that doesn&#8217;t really matter at that time but &#8220;disconnect&#8221; to something you really want to focus. So strategy No.2 is to turn off your phone. It&#8217;s easy to turn on the &#8220;Do Not Disturb&#8221; mode in iPhone.</p>

<p>Then go to somewhere you&#8217;re familiar with, where you won&#8217;t be disturbed by new &#8220;discoveries&#8221;, like the big SALE label in the store, or completely lost that you have to look up your phone to locate yourself. Maybe one of your favorite cafe would be the best at first. I found it&#8217;s easy for me to concerntrate and get serious work(thinking) done when I&#8217;m in the place where I&#8217;m really familiar with. It helps me to build up the routine and get into the &#8220;zone&#8221; so be conscious about the place would be helpful next time.</p>

<h2>Strategy 3: Be a Journalist</h2>

<p>The key point is to become a journalist, to ask good questions to yourself that drive you to focus on the essential area of your life, and <strong>don&#8217;t rush to answer them first.</strong></p>

<p>Often times as an engineer when I hear a concern, issue or trouble I tend to quickly response with a possible solution. But this time I need to shut down that if-then thinking, to allow myself to dig deeper, pause and think more. I think you&#8217;ll be surprised too how much you could get just by pausing for a while.</p>

<p>Here are the questions I asked to myself:</p>

<ul>
<li>For the last 90 days, What is the news in your life?</li>
<li>What are the top 3 things bothering you the most?</li>
<li>Where are you spending your time and resource?</li>
<li>What is essential to you?

<ul>
<li>Identify your roles</li>
</ul>
</li>
<li>If you have full control of a weekday, what would you do?</li>
<li>What is your main focus and goal for the next 90 days? List 3.</li>
<li>What are the top 3 things you know for sure those are gonna improve you, make you grow, but you aren&#8217;t doing? What&#8217;s holding you back?</li>
</ul>


<p>I had some blur images but I definitely didn&#8217;t prepare all questions, most of them were improvised at the time, or should I say I plant the idea 1 week ago and had exactly what I expected.</p>

<h2>Strategy 4: Set A Timer</h2>

<p>I set a timer for 2 hours before I started writing the first question. When I finished I was right on time and I felt that&#8217;s the right amount of time needed.</p>

<p>It&#8217;s not a competition, it&#8217;s not more you write/ask/answer the more you gain. The process and experience is sharable but the end result is not, it&#8217;s for yourself, so don&#8217;t try to get more done during the process. Remember the &#8220;Less But Better&#8221; principle.</p>

<h2>Strategy 5 Digital-less</h2>

<p>I did this with a real pen and notebook. Even though I turned on &#8220;Do Not Disturb&#8221; on my phone, and I did bring an iPad with me, I still like the feeling of writing on physical paper.</p>

<p>It&#8217;s easy to get distracted on digital devices. For me I always care about the styling, spelling and using <em>the right tool</em>, which really doesn&#8217;t matter that much.</p>

<p>Plus the physical note has a limitation, you can&#8217;t write endlessly on one page, which conversely set a boundary to keep you on the right course. I brought a B5 size kinda small notebook in which I tend to answer each question within 1 page, that limitation forces me to describe more precisely and not to bring up everything. Compare to that digital note is border-less and &#8220;cheap&#8221;, even though it shows Page 1 and Page 2, navigation is so &#8220;effortless&#8221; that it won&#8217;t occur to you that you have written &#8220;too much&#8221;.</p>

<h2>Strategy 6: Reschedule It for the next time</h2>

<p>After I finished it I felt much better, I&#8217;ve dumped lots of concerns and worries, set only few goals for the next 90 days, moved some of the actionable items to OmniFocus(my GTD/TODO app). The next thing I did was to schedule the next Personal Quarterly Off-site on my calendar, to reinforce the benefits of Strategy 1 and be more aware the importance of having such kind of self retrospective day.</p>

<h2>Final Thoughts</h2>

<p>Although whole thinking and writing process only took 2 hours to finish, I still think utilizing that whole day to build up the mindset, to allow yourself to pause, to wander is critical for creativity. If you feel like you&#8217;ve got lots of tasks done but not moving towards your goal, maybe it&#8217;s time to do something good for yourself.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-04-12T22:32:00+09:00" pubdate data-updated="true">2015-04-12</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/diary/'>Diary</a>


</div>
	
</div>
</article>


    <article class="post">
	<h1 class="title"><a href="/blog/notes-on-making-peace-with-an-unexpected-life/">Notes on Making Peace with an Unexpected Life</a></h1>
	<div class="entry-content">
		<p>Sharing some takeaways of my favorite podcast, <a href="http://michaelhyatt.com/season-3-episode-09-making-peace-with-an-unexpected-life.html">SEASON 3, EPISODE 9: MAKING PEACE WITH AN UNEXPECTED LIFE</a>, hope this would help me and others to feel a bit better in the unexpected, unknown life.</p>

<blockquote><p>Sometimes you have to make room for what’s unexpected because there’s a miracle there. - MICHELE CUSHATT</p></blockquote>

<div class="video-container">
    <iframe width="560" height="315" src="https://www.youtube.com/embed/DZNAf8Yvu0U" frameborder="0" allowfullscreen></iframe>
</div>


<h2>Gratitude</h2>

<p>My favorit part starts from 9:52.</p>

<blockquote><p>There have been quite a few ups and downs and twists and turns. Well, gratitude in many ways is my lifeline, <strong>because when you’re in a position where you’ve lost so much, where every time you turn around you’re losing something else, it can be very easy to focus on all that’s gone.</strong> I mean, it’s like you just look around and see carnage everywhere you look. You see all of these different things you’ve lost, things you will never get back, and there’s so much grief that’s a part of that.</p>

<p><strong>The only way to push through grief really is to eventually come to some place where you see what you still have left.</strong> So I can either focus on all that I’ve lost or start to identify and recognize what I still have.</p>

<p>That’s not easily done. So I don’t want it to sound trite. I mean, that’s work. That’s serious work, but part of my surgery meant I lost some function of speech. I lost some function of eating ability. I lost my ignorance, being able to naively live, thinking that cancer wouldn’t happen to me, that it only happens to other people. I lost all of those things, which were huge things to grieve. They were massive.</p>

<p>Or I could focus on the fact that, gosh, I have two legs that can go outside and go for a walk, and I have a family. How many people don’t have a family to support them through things like this? I live in the United States, where I have access to great healthcare. How many people don’t have that? I could just start making a list of all of the ways I was incredibly blessed. What it did was just kind of weigh the scales differently, so rather than it being such a huge weight of how much I’d lost, now all of a sudden the scales weighed pretty heavily with what I still had.</p></blockquote>

<h2>This Is Bigger Than Me. I Need Some Help.</h2>

<blockquote><p>One thing I want to say on that topic is that my thought was that I was weak. The fact that I had to do this meant that I wasn’t strong enough. The question I kept asking myself was, “What’s wrong with you, Michele, that you can’t do this? What’s wrong with you?”</p>

<p>That wasn’t the right question. I eventually learned how to be a little kinder to myself. “Well, of course you’re exhausted. Look what has happened.”, “Look what you’ve been through.”, “Look what has gone on.” To offer that grace to yourself a little bit more and understand that <strong>true strength is being willing to say, “Okay, this is bigger than me. I need some help,” is important.</strong></p></blockquote>

<h2>Overall Whole</h2>

<blockquote><p>If we look at just one particular chapter, one particular scene, we can get really overcome with the weight of what’s happening in that moment, but if we can step back and see the overall transition and flow of the story that’s taking shape in our lives, all of a sudden it becomes something that’s quite a beautiful piece of art. But you just can’t look at it one slice at a time. You have to see the overall whole, and when you do, you’ll realize there is an artist who’s weaving all things together for some kind of glorious end, and you get to experience it, but you have to step back and take that kind of vantage point.</p></blockquote>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-03-18T09:08:00+09:00" pubdate data-updated="true">2015-03-18</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/life/'>life</a>


</div>
	
</div>
</article>


    <article class="post">
	<h1 class="title"><a href="/blog/gu-ju-ji-chang-chu-de-cong-cong-na-nian/">古巨基唱出的匆匆那年</a></h1>
	<div class="entry-content">
		<p>匆匆那年的电影我是有去国内的电影院看过的，可惜当时正片刚结束伴随着王菲的匆匆那年，辛勤的工作者们就迅速的开启灯光并挥手指示“出口在这边！”就把观众给疏散掉了，没机会好好听一听。</p>

<p>后来听到古巨基在《我是歌手》里演绎了男声版的匆匆那年，觉得真的是很有感情。用她的话讲就是，王菲唱出的是经历后的美丽，而古巨基唱出的是经历中的痛苦。古巨基谈这首歌的时候说，关键词就是两个字，遗憾。歌词很美，中文很美，故事很美，却是美的遗憾。</p>

<div class="video-container">
    <iframe width="560" height="315" src="https://www.youtube.com/embed/1u6v7eIaO1I?rel=0" frameborder="0" allowfullscreen></iframe>
</div>




<div>
匆匆那年<br> <br>(电影《匆匆那年》主题曲) <br>作词：林夕<br>作曲：梁翘柏 <br>演唱：王菲<br> <br>匆匆那年我们究竟说了几遍 <br>再见之后再拖延<br>可惜谁有没有爱过不是一场 <br>七情上面的雄辩<br>匆匆那年我们一时匆忙撂下<br>难以承受的诺言 <br>只有等别人兑现<br><br>不怪那吻痕还没积累成茧<br>拥抱着冬眠也没能羽化成仙<br>不怪这一段情没空反复再排练<br>是岁月宽容恩赐反悔的时间<br><br>如果再见不能红着眼 <br>是否还能红着脸<br>就像那年匆促刻下永远一起 <br>那样美丽的谣言<br>如果过去还值得眷恋 <br>别太快冰释前嫌<br>谁甘心就这样 <br>彼此无挂也无牵<br>我们要互相亏欠<br>要不然凭何怀缅<br><br>匆匆那年我们见过太少世面 <br>只爱看同一张脸<br>那么莫名其妙那么讨人欢喜 <br>闹起来又太讨厌<br>相爱那年活该匆匆因为我们<br>不懂顽固的诺言 <br>只是分手的前言<br><br>不怪那天太冷泪滴水成冰<br>春风也一样没吹进凝固的照片<br>不怪每一个人没能完整爱一遍<br>是岁月善意落下残缺的悬念<br><br>如果再见不能红着眼 <br>是否还能红着脸<br>就像那年匆促刻下永远一起 <br>那样美丽的谣言<br>如果过去还值得眷恋 <br>别太快冰释前嫌<br>谁甘心就这样彼此无挂也无牵<br>如果再见不能红着眼 <br>是否还能红着脸<br>就像那年匆促刻下永远一起 <br>那样美丽的谣言<br>如果过去还值得眷恋 <br>别太快冰释前嫌<br>谁甘心就这样彼此无挂也无牵<br>我们要互相亏欠<br>我们要藕断丝连
 </div>


		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-02-19T09:26:00+09:00" pubdate data-updated="true">2015-02-19</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/lyrics/'>Lyrics</a>


</div>
	
</div>
</article>


    <article class="post">
	<h1 class="title"><a href="/blog/sorry-i-failed-to-give-you-a-complete-family/">Sorry I Failed to Give You A Complete Family</a></h1>
	<div class="entry-content">
		<p>&#8220;Sorry I failed to give you a complete family&#8221;. I heard it from both my mom and dad, from time to time.</p>

<p>Every time I go back China, I&#8217;m actually scared in some level to spend nights with either of them. I could sense it, &#8220;Oh my god he/she is gonna bring that again&#8230;&#8221;, then we all drowned in the emotional flood.</p>

<p>Although I do refer to them as a convenient &#8220;excuse&#8221;(joke) for my inappropriate behavior or inability of communication, in my heart I never ever blame them for anything. But as parents with good will and intention, I guess they may never forgive themselves, I don&#8217;t like to see that kind of face&#8230;</p>

<p>Writing these because I had a dream this morning, for the 30 years in my life it is the first time to have such a dream seeing them being together, happy, smiling, doing things together, worrying about my marriage(this part is so real hah), I just can&#8217;t forget that warm feeling. If one day human technology is developed enough to make a machine that could control your dream, I might surrender to that.</p>

<p>Phew, what an emotional morning! And I won&#8217;t surrender! I was just being weak for now. And no such thing as a &#8220;functional family&#8221; so take it easy :)</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-02-10T08:38:00+09:00" pubdate data-updated="true">2015-02-10</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/diary/'>Diary</a>


</div>
	
</div>
</article>


    <article class="post">
	<h1 class="title"><a href="/blog/one-pitfall-about-saving/">One Pitfall About Saving Money</a></h1>
	<div class="entry-content">
		<p>I consider myself strict at spending money. I would choose a station in 20 minutes walk distance over a 3 minutes one just to save less than 200 JPY yen. I would  bypass a vending machine even though I’m thirsty but not buying a bottle of water. I would go into bathroom without turning on the light, and choose wearing more clothes rather than turning on underfloor heat to save electricity expense, the list goes on and on… (most of these habits are inherited from my parents, saving money is like a gene inside their body)</p>

<p>Some time ago I randomly picked up a book in bookstore, one chapter was about saving money. Can’t remember the exact word, but the general idea is this:</p>

<blockquote><p>People who have the habits of saving money, tend to buy more and/or expensive stuff than they need, have low resist to the temptation, because they don’t know the joy of spending money, they think they have been suffered enough that they so <em>deserve</em> to have that one item.</p></blockquote>

<p>That rings a bell. I do remember I say something like that to myself in the past when struggling with buy or not buy situation.</p>

<p>“Come on you’ve been working so hard, you definitely deserve this!”</p>

<p>“Look at others, see how they’ve spent money on drinks, clothes, parties, no harm to indulge yourself a bit this time!”</p>

<p>“It’s 50% off sale, you’ve got to buy something for yourself right?!”</p>

<p>And things I’ve bought under that mindset usually turns out to be a total waste: either I don’t like it, not using it anymore(like clothes), or over spec that’s higher than my need(pc parts).</p>

<p>Since I realized this pitfall, I’ve been really conscious about the conversations with myself. <strong>I stopped using the word “deserve”.</strong> Now it looks like this: “I choose to spend the money because of …, so that I could …, I’m 100% it’ll contribute to my …, I know it’s a clear YES, it’s a worthwhile investment, not because I deserve it, not because it’s on 30%, 50% or even 80% sale, not because I feel shy to say NO.”</p>

<p>I could be spending <em>more</em> money overall on food, books, self investment now than before, but that’s my rational choice &amp; investment under conscious mind, with a purpose on health, learning, and self growth. <strong>Most importantly, I don’t feel the urge to indulge myself, the guilty when spending money anymore.</strong></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-01-02T09:29:00+09:00" pubdate data-updated="true">2015-01-02</time></div>
	<div class="tags">

</div>
	
</div>
</article>


    <article class="post">
	<h1 class="title"><a href="/blog/review-2014/">Review 2014</a></h1>
	<div class="entry-content">
		<p>2014 has passed, this is the perfect season to write a personal review post. This one is organized in the perspective of family, relationship, friends work and self development.</p>

<h2>Family</h2>

<p>At the end of 2014 I took some day off and came back to China to visit my mom and dad. Probably 3 years since our last met.</p>

<p>As always my mom prepared <em>everything</em> for me: new clothes and coat, cloves, shoes(-20 degree in my hometown), good foods, money for me to use here… She kept all the gifts in the perfect shape I gave her before, always seek to connect, always support me… Amazingly I really can’t find any flaws from her as a mother, she’s perfect.</p>

<p>My dad is the same, so <em>unique</em> in his own way… I’m not a good talker just like him, we don’t talk that much, and don’t feel the urge to, which made me really relaxed, felt home. Sometimes I take the initiative and tell him my life in Tokyo, and after my talk he either suddenly leaves without a comment or change the subject completely to something he wants to talk about… And we’re totally fine about spending the time separately even though we’re in the same room, he checks his computer while I write blog, just like the old days.</p>

<p>Strangely for one moment I dreamed about, what if, what if they didn’t get divorced, how would it look like now? What if I look at the left there’s my mom, and turn right there’s dad? I know it’s 200% impossible already, but this is the first time for the last 10+ years I imagined such scene and I kinda want to say, “please don’t wake me up”.</p>

<h2>Relationship</h2>

<p>I remember early 2014 we were sitting at the dining table in our brand new house, having afternoon tea and cakes, enjoying the beautiful view from 27th floor and sharing stories to each other. That was such a peaceful picture in my memory, I wish I could freeze the time forever, I thought after all these years we finally managed to get the harmony moment, but we didn’t.</p>

<p>After that our relationship hit the bottom, it was the darkest time for me. I suffered a lot from distrust, every couple have fights and may even say some harsh words too, but nothing hurt more than distrust. I felt my character, loyalty and integrity was doubted, it made me feel all the things I had been fighting for was nothing, worthless. I started to ask the wrong questions. “Why me? Why shit things always happen to me? Why I can’t have a peaceful day? I’m not a perfect boyfriend but also not a bad guy shouldn’t I deserve a little better? Why I did nothing but is treated like I was cheating on her? It’s so unfair why?”</p>

<p><strong>Question shifts focus.</strong> Asking the wrong questions could only   drive you crazy, making all possible negative impacts, so stop. <strong>Pain is a powerful tool, if you can make good use of it.</strong> There’s a technique introduced in the book “Awaken the Giant Within”, saying if you want to quit your bad habit, you should link massive pain to that. In my case this trust issue was such a huge pain for me I don’t want to experience it anymore, ever. So I tweaked the questions like this:</p>

<p>“What’s the root cause? Am I misbehaved? Or lack of communication makes me appear suspicious? Is it related to our past issue? Is it her issue? Is it fixable? What could I do now on my side? What are my choices?”</p>

<p>Immediately my focus shifted to the present, and helped me made a big decision then. I’ll leave all that pain to 2014, 2015 I will have a better, brighter life.</p>

<h2>Friends</h2>

<p>I like to hang out with friends, but not doing good job at inviting them. Always reluctant to send the message. 8:00 AM, maybe they’re on the train. 10:00 AM they must be working. 12:00 AM they’re probably having lunch with colleagues. 6:00 PM, hmm maybe working hard to get things done. 8:00 PM maybe they’re enjoying dinner with family/friends. 10:00 PM maybe too late… I’m such a genius to find no good time to contact during a whole day lol!</p>

<p>And even though I’ve been living in Tokyo for 7 years, I still don’t get the distance with Japanese friends(not those have experience abroad). I consider some are good friends, but not sure how they feel about me, the distance is still there. Don’t get me wrong they’re good people, polite and kind, but that also confused me about where we are, and how to develop it to the next level.</p>

<p>On the contrary, I’m glad the “gaijin” group get together regularly. BBQ, Chicago Pizza, fireworks, Bounenkai. The psychological guard is low, people are more open, more casual, easier to talk to.</p>

<p>Also appreciate my friends in China. Every time I come back, they all manage to come no matter how busy they’re, give me the welcome party and farewell party within 1 week, I’m flattered. I’ve known each other for over 10 years, I’ve seen them from slim to fat hah, from a boy to a father, yet we still drink like a teenage, talk in the same way, as if time never passed us.</p>

<h2>Work</h2>

<p>One big challenge was building Cooksnaps widget which is integrated to food blogs with fancy features like user login, browse and like cooksnaps, leave comments, auto post to facebook  wall, admin tools to manage visibilities, etc. I did heavy javascript project before but this time is different. It’s a 3rd party javascript widget running on the food bloggers blog, the code is part of a rails project. Challenging but fun! <a href="http://www.amazon.co.jp/gp/product/1617290548?aToken=5%7Cuuq49ZVp7MEO9i9Au2s%2Fbo1yGsCLQvwV4fUIaoMceCst6zYl%2FdRwnhhXIqbPm6wi2M4IUbFTXvKVGmog6cyUSWNUsJEC%2FX%2FYzI9coSU%2BYNDRfpbr3iSgw5IeZrwrNy2HXvEp2qu31JOswUQjzfJIH3XqBy26CHkOyyfPucmoR0aKQsNZGk7AP%2Br8DNdR7QIHQCKG0hNRXDxr8f%2Bt2DHtxT%2Bnk5nRZ9sPA7GHdRtpN04%3D&amp;openid.assoc_handle=amzn_associates_jp&amp;openid.claimed_id=https%3A%2F%2Fwww.amazon.co.jp%2Fap%2Fid%2Famzn1.account.AHPYXWO7BRMZJA5MI5V7OUF3I7XQ&amp;openid.identity=https%3A%2F%2Fwww.amazon.co.jp%2Fap%2Fid%2Famzn1.account.AHPYXWO7BRMZJA5MI5V7OUF3I7XQ&amp;openid.mode=id_res&amp;openid.ns=http%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0&amp;openid.ns.pape=http%3A%2F%2Fspecs.openid.net%2Fextensions%2Fpape%2F1.0&amp;openid.op_endpoint=https%3A%2F%2Fwww.amazon.co.jp%2Fap%2Fsignin&amp;openid.pape.auth_policies=http%3A%2F%2Fschemas.openid.net%2Fpape%2Fpolicies%2F2007%2F06%2Fnone&amp;openid.pape.auth_time=2015-01-01T03%3A10%3A17Z&amp;openid.response_nonce=2015-01-01T03%3A10%3A17Z14966822886736948&amp;openid.return_to=https%3A%2F%2Fwww.amazon.co.jp%2Fgp%2Fproduct%2F1617290548%3Fie%3DUTF8&amp;openid.sig=xYlzI2W798ZfZrLpqyLFD3Mdvf50fQ92PBQZbq90QhA%3D&amp;openid.signed=assoc_handle%2CaToken%2Cclaimed_id%2Cidentity%2Cmode%2Cns%2Cop_endpoint%2Cresponse_nonce%2Creturn_to%2Cns.pape%2Cpape.auth_policies%2Cpape.auth_time%2Csigned&amp;redirect=true&amp;serial=">Third-Party Javascript</a>, this book written by Disqus engineers helped a lot!</p>

<p>Another big project is Cookpad global, it’s like a database-less rails app, we’re using API to transfer all the data we needed. At first we were using a gem called <a href="https://github.com/remiprev/her">Her</a> to let the model have ActiveRecord like interface, but due to performance problems and lack of maintenance we shifted to <a href="https://github.com/balvig/spyke">spyke</a>.</p>

<p>Oh and almost forgot that I switched to VIM from Sublime Text, felt like long long time ago :) The transition phase didn’t take long, I used <a href="https://github.com/carlhuda/janus">janus</a> for a quick bootstrap then tweaked the parts one by one everyday. Love it so much.</p>

<h2>Self</h2>

<p>Some achievements on personal development:</p>

<ul>
<li>Established the habit of going to gym 3 times a week</li>
<li>Established the habit of writing a journal every day</li>
<li>Challenging Audible audio book(“challenge” because of my English skill is still not enough to catch all the audio)</li>
<li>Shifting to principle centered person, made first draft of personal mission statement</li>
<li>Become an amateur Youtuber: published a <a href="https://www.youtube.com/channel/UCwwhvJhX8ZqMoTsrKlkvrug">gaming channel</a> now have 566 subscribers, 500k views, generated about $277 income, estimated watched time is 3 years 280 days in total.</li>
</ul>


<h2>The Number of 2015</h2>

<p>2015 = 1024 + 512 + 256 + 128 + 64 + 16 + 8 + 4 + 2 + 1. Such a beautiful number isn’t it!? Happy new year~!</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-01-02T00:40:00+09:00" pubdate data-updated="true">2015-01-02</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/diary/'>Diary</a>


</div>
	
</div>
</article>


    <article class="post">
	<h1 class="title"><a href="/blog/good-things-about-turning-into-30/">Good Things about Turning Into 30</a></h1>
	<div class="entry-content">
		<p><img src="http://cdn.kinopyo.com/images/sanshierli.jpg" alt="三十而立" /></p>

<p>This year August I turned into 30, I wasn’t happy at all. In fact I was quite desperate. I felt I accomplished nothing, far away from who I expected to be. Now 4 months later, I finally managed to see the bright side, accepted myself and got physical and mental positive changes in life.</p>

<h2>Gap Between Dreams and Realities</h2>

<p>Turning into 30 is quite a big thing in China. There is a saying “三十而立”, directly translated to “a man should be independent [steadfast] at the age of 30”, nowadays it’s interpreted as financially independent, emotionally mature, have a good family to take care of. I was born and raised in that culture and unavoidably affected by it. When I was in high school, I dreamed about the day when I’m 30 I’d be mature for sure like a real adult, disciplined and principled, knowing everything about life, handle any tough situations well, have a lovely wife, a happy family, maybe even with 2 children, a boy and a girl, and doing my best job to protect them. Sadly none of these happened.</p>

<p>Goals are dreams with deadlines. Even though I had been working hard these years, but I didn’t make it like a real goal with concrete steps to make it happen. That explains why I ended up like this.</p>

<p>I didn’t celebrate that day, I wanted to write a post but couldn’t finish it because of the dark energy. Part of me was still refusing to accept the fact that I’m 30, I felt not young anymore.</p>

<h2>Everything Has To Become Worse Before It&#8217;s Getting Better</h2>

<p>So what would you do if you’re not happy about the situation? You simply change it. One thing I know for sure that if I take the action it would definitely make a positive impact but I’ve never done it yet, is exercise.</p>

<p>Unlike early 20s when I could play intense games 12 hours straight overnight then still manage to finish a whole day lesson in college, nowadays even 1 hour Starcraft II game would make me feel exhausted. Sleeping 7-8 hours is supposed to be enough but I still have to drag myself out of bed each day. I know there must be so many rooms for improvement.</p>

<p>I’ve read it many times in different places that exercise regularly will generate more energy and boost your creativity. Understand it is one thing, but taking actions is another thing. This time I showed no mercy to myself. I went to the gym near my place, asked the staff to give me a tour and immediately signed the paper for the membership. They was suggesting there’s a program will be available soon that I could use a coupon to join with relatively cheaper price, only thing I have to do is wait for it, but I turned it down said I want to do it now, today, I commit to do it, don’t wanna give myself any other chance to make any excuses. <strong>I know taking the actions now is way more valuable than the extra percentage of the price for me.</strong></p>

<p>My goal is not getting big muscles to make myself looking better to attract any females, I want to regain control of my life, to know that I’m capable of improving myself, to have more energies to accomplish the essential things in the future. I have the clarity, I’m absolutely sure about the direction, everything else just naturally happened without any resistance. It was as simple as that.</p>

<p>I am planning to write another post about my routines about going to the gym and some extra benefits.</p>

<h2>Keep The Ball Rolling</h2>

<p>Another side effect of having physical exercise is <strong>paying more attention to health</strong>. I became more conscious about what and when to eat, not like before I ate whatever I wanted, whenever I wanted without limitation. Have vegetables regularly, try to have dinner at least 3 hours before sleep, push dishes away even   though there’s some left if I know it’s enough already, etc. I’m still have little knowledge in this area so I’m also gonna take a cooking lesson to learn more systemically.</p>

<p>Also found myself have more time to read books. <strong>Reading is such an effective way to learn great thoughts from great people, <em>asynchronously</em></strong>. It allows me to constantly revisit my past and recognize which part could have been done differently to have better result. One great thing for getting older is that  you could find so many references from your past when reading, to fully explore the idea in your context, in your real experience.</p>

<p>By reading “The 7 Habits of Highly Effective People” I realized I had been living with impulse not correct principles, and that was why I was so weak to temptations, made several bad decisions  and hurt the people around me. I followed the suggestions from the book and got my first draft of personal mission statement done. Whenever I have to make tough decisions it’s <em>the reference</em> for me to look up, who I want to be, who should I put first, what’s my responsibility. Decisions are never easy, but having correct principles guide me, it makes me look from the big picture, be more determined to my choice and commit to the result no matter it turns out good or bad at that time.</p>

<h2>Willing to Think About Life Plan</h2>

<p>I was never a fan of making long term plan. Even just think about it made me headache. “I just want to enjoy everyday and forget those complex things”, I said to myself.</p>

<p>But now I’m really willing to take the challenge. I know I actually like to plan things, like for a trip, for Christmas, even plans in games. What stopped me from planning my life, was the fear of the future. Family issues, relationship issues, unresolved conflicts, fear of the unknown… Made me feel stressed and overwhelming, so I ran away, used “just enjoy everyday” as the excuse.</p>

<p>Every family has a issue, so does relationship. You can’t run forever. I started to explore the options and possibilities, it wasn’t as hard as I expected. I could still breathe, it didn’t kill me. Be proactive, take the initiative also applies here. It has to be me to handle these things.</p>

<h2>At Last</h2>

<p>None of these changes require you to physically be the age of 30, but I surrendered to the fear of the future before and was unable to see things clearly, unwilling to deal with them, until now. For what it&#8217;s worth, I’m glad I overcame all the internal struggles, it’s never too late to make a meaningful life.</p>

<p>I&#8217;ll end with some of my favorite quotes:</p>

<blockquote><p>Life is a gift, go make it count. - Michael Hyatt</p>

<p>The only true security in life comes from knowing that every single day you are improving yourself in some way, that you are increasing the caliber of who you are and that you are valuable to your company, your friends, and your family. - Anthony Robbins</p></blockquote>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2014-12-31T12:30:00+09:00" pubdate data-updated="true">2014-12-31</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/diary/'>Diary</a>


</div>
	
</div>
</article>


    <article class="post">
	<h1 class="title"><a href="/blog/run-delayedjob-manually-in-test-env/">Run DelayedJob Manually in Test Env</a></h1>
	<div class="entry-content">
		<h2>TL;DR</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># in config/initializers/delayed_job_config.rb</span>
</span><span class='line'><span class="ss">Delayed</span><span class="p">:</span><span class="ss">:Worker</span><span class="o">.</span><span class="n">delay_jobs</span> <span class="o">=</span> <span class="kp">true</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># in your spec</span>
</span><span class='line'><span class="ss">Delayed</span><span class="p">:</span><span class="ss">:Worker</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">work_off</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Common Setup of DelayedJob</h2>

<p>Assume you follow <a href="https://github.com/collectiveidea/delayed_job#gory-details">DelayedJob readme example</a> to configure it like this: <code>Delayed::Worker.delay_jobs = !Rails.env.test?</code>, what it does is in test env it doesn’t delay the job, meaning DelayedJob is being <em>transparent</em>, the job you put will be executed in “real time”. In most cases you don’t even need to worry about it, your test should be just fine, but recently it caught me…</p>

<h2>It Fails When…</h2>

<p>To give some background, I’m working on a API centric rails project. In order to authenticate with API we pass in access token for every request, and that’s done in the middleware layer. Since access token is stored in cookie, and in middleware we can’t access browser cookie directly, so another tool called <a href="https://github.com/steveklabnik/request_store">RequestStore</a> is used. If in the same request, what you stored in RequestStore you can access it later no matter the context, a unrealistic example would be you store a cookie value to RequestStore then use it in model later. Don’t do that :).</p>

<p>The code below is a simplified version to illustrate the flow.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">ApplicationController</span> <span class="o">&lt;</span> <span class="ss">ActionController</span><span class="p">:</span><span class="ss">:Base</span>
</span><span class='line'>  <span class="n">before_action</span> <span class="ss">:set_api_access_token</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">set_api_access_token</span>
</span><span class='line'>    <span class="no">RequestStore</span><span class="o">.</span><span class="n">store</span><span class="o">[</span><span class="ss">:access_token</span><span class="o">]</span> <span class="o">=</span> <span class="n">cookies</span><span class="o">.</span><span class="n">signed</span><span class="o">[</span><span class="ss">:access_token</span><span class="o">]</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">Authentication</span> <span class="o">&lt;</span> <span class="ss">Faraday</span><span class="p">:</span><span class="ss">:Middleware</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
</span><span class='line'>    <span class="n">env</span><span class="o">[</span><span class="ss">:request_headers</span><span class="o">][</span><span class="s1">&#39;Authorization&#39;</span><span class="o">]</span> <span class="o">=</span> <span class="no">RequestStore</span><span class="o">[</span><span class="ss">:access_token</span><span class="o">]</span> <span class="k">if</span> <span class="no">RequestStore</span><span class="o">[</span><span class="ss">:access_token</span><span class="o">]</span>
</span><span class='line'>    <span class="vi">@app</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Every api request happened inside the rails <code>ApplicationController</code> stack should have the access token being set, but what would happen in a different context like rake task or DelayedJob where you need to send request to the API? The <code>before_action</code> is not gonna be executed there so <code>RequestStore[:access_token]</code> would be nil. This is an easy-to-spot issue <em>if</em> you try it once, but if you follow the TDD work flow and write test for it first, then it’ll fail you.</p>

<p>With <code>Delayed::Worker.delay_jobs</code> set to <code>false</code> in test env, the job will be executed immediately in the same request, so the <code>RequestStore[:access_token]</code> still contains the value and will pass to the Authorization header in the middleware, spec passed but but in real world env it failed. Typical false positive result.</p>

<h2>To Run It Manually</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># in config/initializers/delayed_job_config.rb</span>
</span><span class='line'><span class="ss">Delayed</span><span class="p">:</span><span class="ss">:Worker</span><span class="o">.</span><span class="n">delay_jobs</span> <span class="o">=</span> <span class="kp">true</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># in your spec</span>
</span><span class='line'><span class="c1"># here is the code to enqueue a job to DelayedJob queue</span>
</span><span class='line'><span class="n">visit</span> <span class="n">post_path</span><span class="p">(</span><span class="n">post</span><span class="p">)</span>
</span><span class='line'><span class="c1"># run it manually</span>
</span><span class='line'><span class="ss">Delayed</span><span class="p">:</span><span class="ss">:Worker</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">work_off</span>
</span><span class='line'><span class="c1"># expectation</span>
</span><span class='line'><span class="n">expect</span><span class="p">(</span><span class="n">api_endpoint</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">have_been_requested</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>Delayed::Worker.new.work_off</code> returns an Array like <code>[1, 0]</code> indicating succeeded job counts and failed job counts. I’ve also seen some people testing against that like <code>expect(Delayed::Worker.new.work_off).to eq([1, 0])</code>, personally I don’t think it’s necessary.</p>

<ol>
<li>You have your own expectation right after that and that should be the main concern of the spec. If the job failed, your spec should be failed too.</li>
<li>What if multiple jobs are enqueued while you’re only focusing one of them in the spec? Update the value to <code>[2, 0]</code>? That’s just noise.</li>
</ol>


<p>I guess what I encountered is a rare case, but definitely an interesting case. I kinda prefer this way to mimic real world environment to prevent any possible regressions.</p>

<p>Commercial time: If you’re about to build a API centric rails app, be sure to check out the awesome gem called <a href="https://github.com/balvig/spyke">spyke</a> made by <a href="https://twitter.com/balvig">@balvig</a>, the slogan is “Interact with remote REST services in an ActiveRecord-like manner.”</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2014-12-13T14:18:00+09:00" pubdate data-updated="true">2014-12-13</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/rails-test/'>Rails,Test</a>


</div>
	
</div>
</article>

<nav id="pagenavi">
    
    
        <a href="/blog/page/2/" class="next">Next</a>
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav></div>
	<footer id="footer" class="inner">Copyright &copy; 2015

    Qihuan Piao

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'kinopyoblog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-33226278-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>



</body>
</html>