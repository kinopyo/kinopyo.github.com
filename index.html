
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Kinopyo Blog</title>
	<meta name="author" content="Qihuan Piao">

	
	<meta name="description" content="Sharing some takeaways of my favorite podcast, SEASON 3, EPISODE 9: MAKING PEACE WITH AN UNEXPECTED LIFE, hope this would help me and others to feel &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="http://feeds.feedburner.com/kinopyo" rel="alternate" title="Kinopyo Blog" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
</head>

<body>
	<header id="header" class="inner"><h1><a href="/">Kinopyo Blog</a></h1>
<nav id="main-nav"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
  <li><a href="http://about.me/kinopyo">About</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
  <li><a href="http://about.me/kinopyo">About</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:kinopyo.com">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		
		<a class="twitter" href="http://twitter.com/fantasyday" title="Twitter">Twitter</a>
		
		
		<a class="github" href="https://github.com/kinopyo" title="GitHub">GitHub</a>
		
		
		
		
		
		<a class="rss" href="http://feeds.feedburner.com/kinopyo" title="RSS">RSS</a>
		
	</div>
	<form class="search" action="http://google.com/search" method="get" id="search_form">
		<input class="alignright" type="text" name="g" results="0">
		<input type="hidden" name="q" value="site:kinopyo.com">
	</form>
</nav>

</header>
  
    <header id='about_me' class="inner">
      <div class="photo">
        <img src="http://cdn.kinopyo.com/images/profile.jpg" alt="Photo - Qihuan Piao">
      </div>
      <h3>Hi I'm Qihuan Piao, I'm a Rails developer and I like to make stuff.</h3>
      <p>
        Here I share articles and tips about web development, inpirations and thoughts I get from books and daily life.
      </p>
      <p>I believe that English is a <strong>MUST</strong> skill for me to become a great engineer, so I’m trying to to write posts in it these days.</p>
    </header>

  

	<div id="content" class="inner">


    <article class="post">
	<h1 class="title"><a href="/blog/notes-on-making-peace-with-an-unexpected-life/">Notes on Making Peace with an Unexpected Life</a></h1>
	<div class="entry-content">
		<p>Sharing some takeaways of my favorite podcast, <a href="http://michaelhyatt.com/season-3-episode-09-making-peace-with-an-unexpected-life.html">SEASON 3, EPISODE 9: MAKING PEACE WITH AN UNEXPECTED LIFE</a>, hope this would help me and others to feel a bit better in the unexpected, unknown life.</p>

<blockquote><p>Sometimes you have to make room for what’s unexpected because there’s a miracle there. - MICHELE CUSHATT</p></blockquote>

<div class="video-container">
    <iframe width="560" height="315" src="https://www.youtube.com/embed/DZNAf8Yvu0U" frameborder="0" allowfullscreen></iframe>
</div>


<h2>Gratitude</h2>

<p>My favorit part starts from 9:52.</p>

<blockquote><p>There have been quite a few ups and downs and twists and turns. Well, gratitude in many ways is my lifeline, <strong>because when you’re in a position where you’ve lost so much, where every time you turn around you’re losing something else, it can be very easy to focus on all that’s gone.</strong> I mean, it’s like you just look around and see carnage everywhere you look. You see all of these different things you’ve lost, things you will never get back, and there’s so much grief that’s a part of that.</p>

<p><strong>The only way to push through grief really is to eventually come to some place where you see what you still have left.</strong> So I can either focus on all that I’ve lost or start to identify and recognize what I still have.</p>

<p>That’s not easily done. So I don’t want it to sound trite. I mean, that’s work. That’s serious work, but part of my surgery meant I lost some function of speech. I lost some function of eating ability. I lost my ignorance, being able to naively live, thinking that cancer wouldn’t happen to me, that it only happens to other people. I lost all of those things, which were huge things to grieve. They were massive.</p>

<p>Or I could focus on the fact that, gosh, I have two legs that can go outside and go for a walk, and I have a family. How many people don’t have a family to support them through things like this? I live in the United States, where I have access to great healthcare. How many people don’t have that? I could just start making a list of all of the ways I was incredibly blessed. What it did was just kind of weigh the scales differently, so rather than it being such a huge weight of how much I’d lost, now all of a sudden the scales weighed pretty heavily with what I still had.</p></blockquote>

<h2>This Is Bigger Than Me. I Need Some Help.</h2>

<blockquote><p>One thing I want to say on that topic is that my thought was that I was weak. The fact that I had to do this meant that I wasn’t strong enough. The question I kept asking myself was, “What’s wrong with you, Michele, that you can’t do this? What’s wrong with you?”</p>

<p>That wasn’t the right question. I eventually learned how to be a little kinder to myself. “Well, of course you’re exhausted. Look what has happened.”, “Look what you’ve been through.”, “Look what has gone on.” To offer that grace to yourself a little bit more and understand that <strong>true strength is being willing to say, “Okay, this is bigger than me. I need some help,” is important.</strong></p></blockquote>

<h2>Overall Whole</h2>

<blockquote><p>If we look at just one particular chapter, one particular scene, we can get really overcome with the weight of what’s happening in that moment, but if we can step back and see the overall transition and flow of the story that’s taking shape in our lives, all of a sudden it becomes something that’s quite a beautiful piece of art. But you just can’t look at it one slice at a time. You have to see the overall whole, and when you do, you’ll realize there is an artist who’s weaving all things together for some kind of glorious end, and you get to experience it, but you have to step back and take that kind of vantage point.</p></blockquote>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-03-18T09:08:00+09:00" pubdate data-updated="true">2015-03-18</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/life/'>life</a>


</div>
	
</div>
</article>


    <article class="post">
	<h1 class="title"><a href="/blog/gu-ju-ji-chang-chu-de-cong-cong-na-nian/">古巨基唱出的匆匆那年</a></h1>
	<div class="entry-content">
		<p>匆匆那年的电影我是有去国内的电影院看过的，可惜当时正片刚结束伴随着王菲的匆匆那年，辛勤的工作者们就迅速的开启灯光并挥手指示“出口在这边！”就把观众给疏散掉了，没机会好好听一听。</p>

<p>后来听到古巨基在《我是歌手》里演绎了男声版的匆匆那年，觉得真的是很有感情。用她的话讲就是，王菲唱出的是经历后的美丽，而古巨基唱出的是经历中的痛苦。古巨基谈这首歌的时候说，关键词就是两个字，遗憾。歌词很美，中文很美，故事很美，却是美的遗憾。</p>

<div class="video-container">
    <iframe width="560" height="315" src="https://www.youtube.com/embed/1u6v7eIaO1I?rel=0" frameborder="0" allowfullscreen></iframe>
</div>




<div>
匆匆那年<br> <br>(电影《匆匆那年》主题曲) <br>作词：林夕<br>作曲：梁翘柏 <br>演唱：王菲<br> <br>匆匆那年我们究竟说了几遍 <br>再见之后再拖延<br>可惜谁有没有爱过不是一场 <br>七情上面的雄辩<br>匆匆那年我们一时匆忙撂下<br>难以承受的诺言 <br>只有等别人兑现<br><br>不怪那吻痕还没积累成茧<br>拥抱着冬眠也没能羽化成仙<br>不怪这一段情没空反复再排练<br>是岁月宽容恩赐反悔的时间<br><br>如果再见不能红着眼 <br>是否还能红着脸<br>就像那年匆促刻下永远一起 <br>那样美丽的谣言<br>如果过去还值得眷恋 <br>别太快冰释前嫌<br>谁甘心就这样 <br>彼此无挂也无牵<br>我们要互相亏欠<br>要不然凭何怀缅<br><br>匆匆那年我们见过太少世面 <br>只爱看同一张脸<br>那么莫名其妙那么讨人欢喜 <br>闹起来又太讨厌<br>相爱那年活该匆匆因为我们<br>不懂顽固的诺言 <br>只是分手的前言<br><br>不怪那天太冷泪滴水成冰<br>春风也一样没吹进凝固的照片<br>不怪每一个人没能完整爱一遍<br>是岁月善意落下残缺的悬念<br><br>如果再见不能红着眼 <br>是否还能红着脸<br>就像那年匆促刻下永远一起 <br>那样美丽的谣言<br>如果过去还值得眷恋 <br>别太快冰释前嫌<br>谁甘心就这样彼此无挂也无牵<br>如果再见不能红着眼 <br>是否还能红着脸<br>就像那年匆促刻下永远一起 <br>那样美丽的谣言<br>如果过去还值得眷恋 <br>别太快冰释前嫌<br>谁甘心就这样彼此无挂也无牵<br>我们要互相亏欠<br>我们要藕断丝连
 </div>


		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-02-19T09:26:00+09:00" pubdate data-updated="true">2015-02-19</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/lyrics/'>Lyrics</a>


</div>
	
</div>
</article>


    <article class="post">
	<h1 class="title"><a href="/blog/sorry-i-failed-to-give-you-a-complete-family/">Sorry I Failed to Give You A Complete Family</a></h1>
	<div class="entry-content">
		<p>&#8220;Sorry I failed to give you a complete family&#8221;. I heard it from both my mom and dad, from time to time.</p>

<p>Every time I go back China, I&#8217;m actually scared in some level to spend nights with either of them. I could sense it, &#8220;Oh my god he/she is gonna bring that again&#8230;&#8221;, then we all drowned in the emotional flood.</p>

<p>Although I do refer to them as a convenient &#8220;excuse&#8221;(joke) for my inappropriate behavior or inability of communication, in my heart I never ever blame them for anything. But as parents with good will and intention, I guess they may never forgive themselves, I don&#8217;t like to see that kind of face&#8230;</p>

<p>Writing these because I had a dream this morning, for the 30 years in my life it is the first time to have such a dream seeing them being together, happy, smiling, doing things together, worrying about my marriage(this part is so real hah), I just can&#8217;t forget that warm feeling. If one day human technology is developed enough to make a machine that could control your dream, I might surrender to that.</p>

<p>Phew, what an emotional morning! And I won&#8217;t surrender! I was just being weak for now. And no such thing as a &#8220;functional family&#8221; so take it easy :)</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-02-10T08:38:00+09:00" pubdate data-updated="true">2015-02-10</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/diary/'>Diary</a>


</div>
	
</div>
</article>


    <article class="post">
	<h1 class="title"><a href="/blog/one-pitfall-about-saving/">One Pitfall About Saving Money</a></h1>
	<div class="entry-content">
		<p>I consider myself strict at spending money. I would choose a station in 20 minutes walk distance over a 3 minutes one just to save less than 200 JPY yen. I would  bypass a vending machine even though I’m thirsty but not buying a bottle of water. I would go into bathroom without turning on the light, and choose wearing more clothes rather than turning on underfloor heat to save electricity expense, the list goes on and on… (most of these habits are inherited from my parents, saving money is like a gene inside their body)</p>

<p>Some time ago I randomly picked up a book in bookstore, one chapter was about saving money. Can’t remember the exact word, but the general idea is this:</p>

<blockquote><p>People who have the habits of saving money, tend to buy more and/or expensive stuff than they need, have low resist to the temptation, because they don’t know the joy of spending money, they think they have been suffered enough that they so <em>deserve</em> to have that one item.</p></blockquote>

<p>That rings a bell. I do remember I say something like that to myself in the past when struggling with buy or not buy situation.</p>

<p>“Come on you’ve been working so hard, you definitely deserve this!”</p>

<p>“Look at others, see how they’ve spent money on drinks, clothes, parties, no harm to indulge yourself a bit this time!”</p>

<p>“It’s 50% off sale, you’ve got to buy something for yourself right?!”</p>

<p>And things I’ve bought under that mindset usually turns out to be a total waste: either I don’t like it, not using it anymore(like clothes), or over spec that’s higher than my need(pc parts).</p>

<p>Since I realized this pitfall, I’ve been really conscious about the conversations with myself. <strong>I stopped using the word “deserve”.</strong> Now it looks like this: “I choose to spend the money because of …, so that I could …, I’m 100% it’ll contribute to my …, I know it’s a clear YES, it’s a worthwhile investment, not because I deserve it, not because it’s on 30%, 50% or even 80% sale, not because I feel shy to say NO.”</p>

<p>I could be spending <em>more</em> money overall on food, books, self investment now than before, but that’s my rational choice &amp; investment under conscious mind, with a purpose on health, learning, and self growth. <strong>Most importantly, I don’t feel the urge to indulge myself, the guilty when spending money anymore.</strong></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-01-02T09:29:00+09:00" pubdate data-updated="true">2015-01-02</time></div>
	<div class="tags">

</div>
	
</div>
</article>


    <article class="post">
	<h1 class="title"><a href="/blog/review-2014/">Review 2014</a></h1>
	<div class="entry-content">
		<p>2014 has passed, this is the perfect season to write a personal review post. This one is organized in the perspective of family, relationship, friends work and self development.</p>

<h2>Family</h2>

<p>At the end of 2014 I took some day off and came back to China to visit my mom and dad. Probably 3 years since our last met.</p>

<p>As always my mom prepared <em>everything</em> for me: new clothes and coat, cloves, shoes(-20 degree in my hometown), good foods, money for me to use here… She kept all the gifts in the perfect shape I gave her before, always seek to connect, always support me… Amazingly I really can’t find any flaws from her as a mother, she’s perfect.</p>

<p>My dad is the same, so <em>unique</em> in his own way… I’m not a good talker just like him, we don’t talk that much, and don’t feel the urge to, which made me really relaxed, felt home. Sometimes I take the initiative and tell him my life in Tokyo, and after my talk he either suddenly leaves without a comment or change the subject completely to something he wants to talk about… And we’re totally fine about spending the time separately even though we’re in the same room, he checks his computer while I write blog, just like the old days.</p>

<p>Strangely for one moment I dreamed about, what if, what if they didn’t get divorced, how would it look like now? What if I look at the left there’s my mom, and turn right there’s dad? I know it’s 200% impossible already, but this is the first time for the last 10+ years I imagined such scene and I kinda want to say, “please don’t wake me up”.</p>

<h2>Relationship</h2>

<p>I remember early 2014 we were sitting at the dining table in our brand new house, having afternoon tea and cakes, enjoying the beautiful view from 27th floor and sharing stories to each other. That was such a peaceful picture in my memory, I wish I could freeze the time forever, I thought after all these years we finally managed to get the harmony moment, but we didn’t.</p>

<p>After that our relationship hit the bottom, it was the darkest time for me. I suffered a lot from distrust, every couple have fights and may even say some harsh words too, but nothing hurt more than distrust. I felt my character, loyalty and integrity was doubted, it made me feel all the things I had been fighting for was nothing, worthless. I started to ask the wrong questions. “Why me? Why shit things always happen to me? Why I can’t have a peaceful day? I’m not a perfect boyfriend but also not a bad guy shouldn’t I deserve a little better? Why I did nothing but is treated like I was cheating on her? It’s so unfair why?”</p>

<p><strong>Question shifts focus.</strong> Asking the wrong questions could only   drive you crazy, making all possible negative impacts, so stop. <strong>Pain is a powerful tool, if you can make good use of it.</strong> There’s a technique introduced in the book “Awaken the Giant Within”, saying if you want to quit your bad habit, you should link massive pain to that. In my case this trust issue was such a huge pain for me I don’t want to experience it anymore, ever. So I tweaked the questions like this:</p>

<p>“What’s the root cause? Am I misbehaved? Or lack of communication makes me appear suspicious? Is it related to our past issue? Is it her issue? Is it fixable? What could I do now on my side? What are my choices?”</p>

<p>Immediately my focus shifted to the present, and helped me made a big decision then. I’ll leave all that pain to 2014, 2015 I will have a better, brighter life.</p>

<h2>Friends</h2>

<p>I like to hang out with friends, but not doing good job at inviting them. Always reluctant to send the message. 8:00 AM, maybe they’re on the train. 10:00 AM they must be working. 12:00 AM they’re probably having lunch with colleagues. 6:00 PM, hmm maybe working hard to get things done. 8:00 PM maybe they’re enjoying dinner with family/friends. 10:00 PM maybe too late… I’m such a genius to find no good time to contact during a whole day lol!</p>

<p>And even though I’ve been living in Tokyo for 7 years, I still don’t get the distance with Japanese friends(not those have experience abroad). I consider some are good friends, but not sure how they feel about me, the distance is still there. Don’t get me wrong they’re good people, polite and kind, but that also confused me about where we are, and how to develop it to the next level.</p>

<p>On the contrary, I’m glad the “gaijin” group get together regularly. BBQ, Chicago Pizza, fireworks, Bounenkai. The psychological guard is low, people are more open, more casual, easier to talk to.</p>

<p>Also appreciate my friends in China. Every time I come back, they all manage to come no matter how busy they’re, give me the welcome party and farewell party within 1 week, I’m flattered. I’ve known each other for over 10 years, I’ve seen them from slim to fat hah, from a boy to a father, yet we still drink like a teenage, talk in the same way, as if time never passed us.</p>

<h2>Work</h2>

<p>One big challenge was building Cooksnaps widget which is integrated to food blogs with fancy features like user login, browse and like cooksnaps, leave comments, auto post to facebook  wall, admin tools to manage visibilities, etc. I did heavy javascript project before but this time is different. It’s a 3rd party javascript widget running on the food bloggers blog, the code is part of a rails project. Challenging but fun! <a href="http://www.amazon.co.jp/gp/product/1617290548?aToken=5%7Cuuq49ZVp7MEO9i9Au2s%2Fbo1yGsCLQvwV4fUIaoMceCst6zYl%2FdRwnhhXIqbPm6wi2M4IUbFTXvKVGmog6cyUSWNUsJEC%2FX%2FYzI9coSU%2BYNDRfpbr3iSgw5IeZrwrNy2HXvEp2qu31JOswUQjzfJIH3XqBy26CHkOyyfPucmoR0aKQsNZGk7AP%2Br8DNdR7QIHQCKG0hNRXDxr8f%2Bt2DHtxT%2Bnk5nRZ9sPA7GHdRtpN04%3D&amp;openid.assoc_handle=amzn_associates_jp&amp;openid.claimed_id=https%3A%2F%2Fwww.amazon.co.jp%2Fap%2Fid%2Famzn1.account.AHPYXWO7BRMZJA5MI5V7OUF3I7XQ&amp;openid.identity=https%3A%2F%2Fwww.amazon.co.jp%2Fap%2Fid%2Famzn1.account.AHPYXWO7BRMZJA5MI5V7OUF3I7XQ&amp;openid.mode=id_res&amp;openid.ns=http%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0&amp;openid.ns.pape=http%3A%2F%2Fspecs.openid.net%2Fextensions%2Fpape%2F1.0&amp;openid.op_endpoint=https%3A%2F%2Fwww.amazon.co.jp%2Fap%2Fsignin&amp;openid.pape.auth_policies=http%3A%2F%2Fschemas.openid.net%2Fpape%2Fpolicies%2F2007%2F06%2Fnone&amp;openid.pape.auth_time=2015-01-01T03%3A10%3A17Z&amp;openid.response_nonce=2015-01-01T03%3A10%3A17Z14966822886736948&amp;openid.return_to=https%3A%2F%2Fwww.amazon.co.jp%2Fgp%2Fproduct%2F1617290548%3Fie%3DUTF8&amp;openid.sig=xYlzI2W798ZfZrLpqyLFD3Mdvf50fQ92PBQZbq90QhA%3D&amp;openid.signed=assoc_handle%2CaToken%2Cclaimed_id%2Cidentity%2Cmode%2Cns%2Cop_endpoint%2Cresponse_nonce%2Creturn_to%2Cns.pape%2Cpape.auth_policies%2Cpape.auth_time%2Csigned&amp;redirect=true&amp;serial=">Third-Party Javascript</a>, this book written by Disqus engineers helped a lot!</p>

<p>Another big project is Cookpad global, it’s like a database-less rails app, we’re using API to transfer all the data we needed. At first we were using a gem called <a href="https://github.com/remiprev/her">Her</a> to let the model have ActiveRecord like interface, but due to performance problems and lack of maintenance we shifted to <a href="https://github.com/balvig/spyke">spyke</a>.</p>

<p>Oh and almost forgot that I switched to VIM from Sublime Text, felt like long long time ago :) The transition phase didn’t take long, I used <a href="https://github.com/carlhuda/janus">janus</a> for a quick bootstrap then tweaked the parts one by one everyday. Love it so much.</p>

<h2>Self</h2>

<p>Some achievements on personal development:</p>

<ul>
<li>Established the habit of going to gym 3 times a week</li>
<li>Established the habit of writing a journal every day</li>
<li>Challenging Audible audio book(“challenge” because of my English skill is still not enough to catch all the audio)</li>
<li>Shifting to principle centered person, made first draft of personal mission statement</li>
<li>Become an amateur Youtuber: published a <a href="https://www.youtube.com/channel/UCwwhvJhX8ZqMoTsrKlkvrug">gaming channel</a> now have 566 subscribers, 500k views, generated about $277 income, estimated watched time is 3 years 280 days in total.</li>
</ul>


<h2>The Number of 2015</h2>

<p>2015 = 1024 + 512 + 256 + 128 + 64 + 16 + 8 + 4 + 2 + 1. Such a beautiful number isn’t it!? Happy new year~!</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-01-02T00:40:00+09:00" pubdate data-updated="true">2015-01-02</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/diary/'>Diary</a>


</div>
	
</div>
</article>


    <article class="post">
	<h1 class="title"><a href="/blog/good-things-about-turning-into-30/">Good Things about Turning Into 30</a></h1>
	<div class="entry-content">
		<p><img src="http://cdn.kinopyo.com/images/sanshierli.jpg" alt="三十而立" /></p>

<p>This year August I turned into 30, I wasn’t happy at all. In fact I was quite desperate. I felt I accomplished nothing, far away from who I expected to be. Now 4 months later, I finally managed to see the bright side, accepted myself and got physical and mental positive changes in life.</p>

<h2>Gap Between Dreams and Realities</h2>

<p>Turning into 30 is quite a big thing in China. There is a saying “三十而立”, directly translated to “a man should be independent [steadfast] at the age of 30”, nowadays it’s interpreted as financially independent, emotionally mature, have a good family to take care of. I was born and raised in that culture and unavoidably affected by it. When I was in high school, I dreamed about the day when I’m 30 I’d be mature for sure like a real adult, disciplined and principled, knowing everything about life, handle any tough situations well, have a lovely wife, a happy family, maybe even with 2 children, a boy and a girl, and doing my best job to protect them. Sadly none of these happened.</p>

<p>Goals are dreams with deadlines. Even though I had been working hard these years, but I didn’t make it like a real goal with concrete steps to make it happen. That explains why I ended up like this.</p>

<p>I didn’t celebrate that day, I wanted to write a post but couldn’t finish it because of the dark energy. Part of me was still refusing to accept the fact that I’m 30, I felt not young anymore.</p>

<h2>Everything Has To Become Worse Before It&#8217;s Getting Better</h2>

<p>So what would you do if you’re not happy about the situation? You simply change it. One thing I know for sure that if I take the action it would definitely make a positive impact but I’ve never done it yet, is exercise.</p>

<p>Unlike early 20s when I could play intense games 12 hours straight overnight then still manage to finish a whole day lesson in college, nowadays even 1 hour Starcraft II game would make me feel exhausted. Sleeping 7-8 hours is supposed to be enough but I still have to drag myself out of bed each day. I know there must be so many rooms for improvement.</p>

<p>I’ve read it many times in different places that exercise regularly will generate more energy and boost your creativity. Understand it is one thing, but taking actions is another thing. This time I showed no mercy to myself. I went to the gym near my place, asked the staff to give me a tour and immediately signed the paper for the membership. They was suggesting there’s a program will be available soon that I could use a coupon to join with relatively cheaper price, only thing I have to do is wait for it, but I turned it down said I want to do it now, today, I commit to do it, don’t wanna give myself any other chance to make any excuses. <strong>I know taking the actions now is way more valuable than the extra percentage of the price for me.</strong></p>

<p>My goal is not getting big muscles to make myself looking better to attract any females, I want to regain control of my life, to know that I’m capable of improving myself, to have more energies to accomplish the essential things in the future. I have the clarity, I’m absolutely sure about the direction, everything else just naturally happened without any resistance. It was as simple as that.</p>

<p>I am planning to write another post about my routines about going to the gym and some extra benefits.</p>

<h2>Keep The Ball Rolling</h2>

<p>Another side effect of having physical exercise is <strong>paying more attention to health</strong>. I became more conscious about what and when to eat, not like before I ate whatever I wanted, whenever I wanted without limitation. Have vegetables regularly, try to have dinner at least 3 hours before sleep, push dishes away even   though there’s some left if I know it’s enough already, etc. I’m still have little knowledge in this area so I’m also gonna take a cooking lesson to learn more systemically.</p>

<p>Also found myself have more time to read books. <strong>Reading is such an effective way to learn great thoughts from great people, <em>asynchronously</em></strong>. It allows me to constantly revisit my past and recognize which part could have been done differently to have better result. One great thing for getting older is that  you could find so many references from your past when reading, to fully explore the idea in your context, in your real experience.</p>

<p>By reading “The 7 Habits of Highly Effective People” I realized I had been living with impulse not correct principles, and that was why I was so weak to temptations, made several bad decisions  and hurt the people around me. I followed the suggestions from the book and got my first draft of personal mission statement done. Whenever I have to make tough decisions it’s <em>the reference</em> for me to look up, who I want to be, who should I put first, what’s my responsibility. Decisions are never easy, but having correct principles guide me, it makes me look from the big picture, be more determined to my choice and commit to the result no matter it turns out good or bad at that time.</p>

<h2>Willing to Think About Life Plan</h2>

<p>I was never a fan of making long term plan. Even just think about it made me headache. “I just want to enjoy everyday and forget those complex things”, I said to myself.</p>

<p>But now I’m really willing to take the challenge. I know I actually like to plan things, like for a trip, for Christmas, even plans in games. What stopped me from planning my life, was the fear of the future. Family issues, relationship issues, unresolved conflicts, fear of the unknown… Made me feel stressed and overwhelming, so I ran away, used “just enjoy everyday” as the excuse.</p>

<p>Every family has a issue, so does relationship. You can’t run forever. I started to explore the options and possibilities, it wasn’t as hard as I expected. I could still breathe, it didn’t kill me. Be proactive, take the initiative also applies here. It has to be me to handle these things.</p>

<h2>At Last</h2>

<p>None of these changes require you to physically be the age of 30, but I surrendered to the fear of the future before and was unable to see things clearly, unwilling to deal with them, until now. For what it&#8217;s worth, I’m glad I overcame all the internal struggles, it’s never too late to make a meaningful life.</p>

<p>I&#8217;ll end with some of my favorite quotes:</p>

<blockquote><p>Life is a gift, go make it count. - Michael Hyatt</p>

<p>The only true security in life comes from knowing that every single day you are improving yourself in some way, that you are increasing the caliber of who you are and that you are valuable to your company, your friends, and your family. - Anthony Robbins</p></blockquote>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2014-12-31T12:30:00+09:00" pubdate data-updated="true">2014-12-31</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/diary/'>Diary</a>


</div>
	
</div>
</article>


    <article class="post">
	<h1 class="title"><a href="/blog/run-delayedjob-manually-in-test-env/">Run DelayedJob Manually in Test Env</a></h1>
	<div class="entry-content">
		<h2>TL;DR</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># in config/initializers/delayed_job_config.rb</span>
</span><span class='line'><span class="ss">Delayed</span><span class="p">:</span><span class="ss">:Worker</span><span class="o">.</span><span class="n">delay_jobs</span> <span class="o">=</span> <span class="kp">true</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># in your spec</span>
</span><span class='line'><span class="ss">Delayed</span><span class="p">:</span><span class="ss">:Worker</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">work_off</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Common Setup of DelayedJob</h2>

<p>Assume you follow <a href="https://github.com/collectiveidea/delayed_job#gory-details">DelayedJob readme example</a> to configure it like this: <code>Delayed::Worker.delay_jobs = !Rails.env.test?</code>, what it does is in test env it doesn’t delay the job, meaning DelayedJob is being <em>transparent</em>, the job you put will be executed in “real time”. In most cases you don’t even need to worry about it, your test should be just fine, but recently it caught me…</p>

<h2>It Fails When…</h2>

<p>To give some background, I’m working on a API centric rails project. In order to authenticate with API we pass in access token for every request, and that’s done in the middleware layer. Since access token is stored in cookie, and in middleware we can’t access browser cookie directly, so another tool called <a href="https://github.com/steveklabnik/request_store">RequestStore</a> is used. If in the same request, what you stored in RequestStore you can access it later no matter the context, a unrealistic example would be you store a cookie value to RequestStore then use it in model later. Don’t do that :).</p>

<p>The code below is a simplified version to illustrate the flow.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">ApplicationController</span> <span class="o">&lt;</span> <span class="ss">ActionController</span><span class="p">:</span><span class="ss">:Base</span>
</span><span class='line'>  <span class="n">before_action</span> <span class="ss">:set_api_access_token</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">set_api_access_token</span>
</span><span class='line'>    <span class="no">RequestStore</span><span class="o">.</span><span class="n">store</span><span class="o">[</span><span class="ss">:access_token</span><span class="o">]</span> <span class="o">=</span> <span class="n">cookies</span><span class="o">.</span><span class="n">signed</span><span class="o">[</span><span class="ss">:access_token</span><span class="o">]</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">Authentication</span> <span class="o">&lt;</span> <span class="ss">Faraday</span><span class="p">:</span><span class="ss">:Middleware</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
</span><span class='line'>    <span class="n">env</span><span class="o">[</span><span class="ss">:request_headers</span><span class="o">][</span><span class="s1">&#39;Authorization&#39;</span><span class="o">]</span> <span class="o">=</span> <span class="no">RequestStore</span><span class="o">[</span><span class="ss">:access_token</span><span class="o">]</span> <span class="k">if</span> <span class="no">RequestStore</span><span class="o">[</span><span class="ss">:access_token</span><span class="o">]</span>
</span><span class='line'>    <span class="vi">@app</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Every api request happened inside the rails <code>ApplicationController</code> stack should have the access token being set, but what would happen in a different context like rake task or DelayedJob where you need to send request to the API? The <code>before_action</code> is not gonna be executed there so <code>RequestStore[:access_token]</code> would be nil. This is an easy-to-spot issue <em>if</em> you try it once, but if you follow the TDD work flow and write test for it first, then it’ll fail you.</p>

<p>With <code>Delayed::Worker.delay_jobs</code> set to <code>false</code> in test env, the job will be executed immediately in the same request, so the <code>RequestStore[:access_token]</code> still contains the value and will pass to the Authorization header in the middleware, spec passed but but in real world env it failed. Typical false positive result.</p>

<h2>To Run It Manually</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># in config/initializers/delayed_job_config.rb</span>
</span><span class='line'><span class="ss">Delayed</span><span class="p">:</span><span class="ss">:Worker</span><span class="o">.</span><span class="n">delay_jobs</span> <span class="o">=</span> <span class="kp">true</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># in your spec</span>
</span><span class='line'><span class="c1"># here is the code to enqueue a job to DelayedJob queue</span>
</span><span class='line'><span class="n">visit</span> <span class="n">post_path</span><span class="p">(</span><span class="n">post</span><span class="p">)</span>
</span><span class='line'><span class="c1"># run it manually</span>
</span><span class='line'><span class="ss">Delayed</span><span class="p">:</span><span class="ss">:Worker</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">work_off</span>
</span><span class='line'><span class="c1"># expectation</span>
</span><span class='line'><span class="n">expect</span><span class="p">(</span><span class="n">api_endpoint</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">have_been_requested</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>Delayed::Worker.new.work_off</code> returns an Array like <code>[1, 0]</code> indicating succeeded job counts and failed job counts. I’ve also seen some people testing against that like <code>expect(Delayed::Worker.new.work_off).to eq([1, 0])</code>, personally I don’t think it’s necessary.</p>

<ol>
<li>You have your own expectation right after that and that should be the main concern of the spec. If the job failed, your spec should be failed too.</li>
<li>What if multiple jobs are enqueued while you’re only focusing one of them in the spec? Update the value to <code>[2, 0]</code>? That’s just noise.</li>
</ol>


<p>I guess what I encountered is a rare case, but definitely an interesting case. I kinda prefer this way to mimic real world environment to prevent any possible regressions.</p>

<p>Commercial time: If you’re about to build a API centric rails app, be sure to check out the awesome gem called <a href="https://github.com/balvig/spyke">spyke</a> made by <a href="https://twitter.com/balvig">@balvig</a>, the slogan is “Interact with remote REST services in an ActiveRecord-like manner.”</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2014-12-13T14:18:00+09:00" pubdate data-updated="true">2014-12-13</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/rails-test/'>Rails,Test</a>


</div>
	
</div>
</article>


    <article class="post">
	<h1 class="title"><a href="/blog/book-essentialism-the-disciplined-pursuit-of-less/">Book &#8220;Essentialism - The Disciplined Pursuit of Less&#8221;</a></h1>
	<div class="entry-content">
		<p>&#8220;Have you ever found yourself stretched too thin? Have you ever felt both overworked and underutilized? Have you ever found yourself majoring in minor activities? Do you ever feel busy but not productive?&#8221;</p>

<p>This book is about answers to these questions. The <strong>key messages and takeaways for me are</strong>:</p>

<ul>
<li>Life is a tradeoff. You can’t have it all, therefore you have to choose, choose what matters the most. Less, but better.</li>
<li>You have to give yourself permission to say No to others, so you can say Yes to your goal and make highest contribution.</li>
<li>It’s not about getting more things done, it’s about getting the right things done. Effective over productive. I love this so much.</li>
</ul>


<h2>If You Don’t Have Time to Read it…</h2>

<p>Here is a great video reviewing this book, and actually I started reading it because of this video. To be honest I think it might be arguably <em>better</em> than the book itself. If you don’t have enough time, just check out the video, should take you less than 25 minutes.</p>

<div class="video-container">
<iframe width="560" height="315" src="//www.youtube.com/embed/k-mciueg_K0" frameborder="0" allowfullscreen></iframe>
</div>


<h2>Chapters I Would Like to Read Twice</h2>

<p>Part I: Essence: What is the core mind-set of an Essentialist?</p>

<ul>
<li>CHOOSE: The Invincible Power of Choice</li>
<li>DISCERN: The Unimportance of Practically Everything</li>
<li>TRADE-OFF: Which Problems Do I want?</li>
</ul>


<p>Part II: Explore: How can we discern the trivial many from the vital few?</p>

<ul>
<li>SLEEP: Protect the Asset</li>
<li>SELECT: The Power of Extreme Criteria</li>
</ul>


<p>Part III: Eliminate: How can we cut out the trial many?</p>

<ul>
<li>DARE: The Power of a Graceful “No”</li>
</ul>


<p>Part IV: Execute: How can we make doing the vital few things almost effortless?</p>

<ul>
<li>PROGRESS: The Power of Small Wins</li>
</ul>


<h2>Overview</h2>

<p>The first part, the &#8220;What&#8221; part, is really great. All the problems introduced there are so real, I could map literary everything to my real life. Very inspirational.</p>

<p>But sadly the following chapters, the &#8220;how&#8221; part, are less compelling to me. I agree with the general idea, it’s just the examples and evidences are not convincing enough.</p>

<p>Overall it’s a good book, I’d rate it 4 out of 5. It does give me positive energies and courages to improve my life, makes me pause to think about the past, which choices were made by “default”(others) and which were made by “design”(me), makes me think twice before purchase any non-essential items, makes me observe my bad habits &amp; routines and fix them, makes me pursue less but better.</p>

<p>p.s. I didn&#8217;t title this post as &#8220;Book Review&#8221;, as I realized the word &#8220;review&#8221; is too big for me, makes me want to cover every aspect of the book, pros and corns, scan every note and highlight I made during the reading, that is overwhelming and will simplify stops me from writing. “Done is better than perfect”, indeed, the essential thing for me is to write this post and share my findings!</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2014-11-18T20:53:00+09:00" pubdate data-updated="true">2014-11-18</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/book/'>Book</a>


</div>
	
</div>
</article>


    <article class="post">
	<h1 class="title"><a href="/blog/use-activejob-in-rails-4-1/">Use ActiveJob in Rails 4.1</a></h1>
	<div class="entry-content">
		<p>ActiveJob is <a href="http://weblog.rubyonrails.org/2014/8/20/Rails-4-2-beta1/">the headline feature in Rails 4.2</a>, the <a href="http://edgeguides.rubyonrails.org/active_job_basics.html">Active Job Basics on RailsGuides</a> explains the philosophy and usage very well, make sure you’ve checked that first. However there’re some gotchas if you want to use it right now in your Rails 4.1 app. Here I’m gonna show you how to install it in 4.1, and things you need to take extra care of.</p>

<h2>Install ActiveJob in Rails 4.1</h2>

<p>Add <code>activejob</code> to your <code>Gemfile</code> then <code>bundle install</code>.</p>

<p>Create a <code>active_job.rb</code> file under <code>config/initializers</code> and paste code below.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;active_job&#39;</span>
</span><span class='line'><span class="c1"># or any other supported backend such as :sidekiq or :delayed_job</span>
</span><span class='line'><span class="ss">ActiveJob</span><span class="p">:</span><span class="ss">:Base</span><span class="o">.</span><span class="n">queue_adapter</span> <span class="o">=</span> <span class="ss">:inline</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now you should be abel to load ActiveJob in your rails app without error.</p>

<p>Note that the one you installed is not <a href="https://github.com/rails/rails/tree/master/activejob">the one inside the rails repository</a>, that has a version of <a href="https://rubygems.org/gems/activejob/versions/4.2.0.beta2">4.2.0.beta2</a> same as Rails at the time of writing, the one you installed is <a href="https://rubygems.org/gems/activejob/versions/0">version 0</a>. You can find the archived source code from its <a href="https://github.com/rails/activejob">original repository</a>.</p>

<h2>Creating a Job</h2>

<p>To create a job, you have to manually create the <code>app/jobs</code> folder first, then follow the same naming convention to create your job class file like <code>app/jobs/guests_cleanup_job.rb</code>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">GuestsCleanupJob</span> <span class="o">&lt;</span> <span class="ss">ActiveJob</span><span class="p">:</span><span class="ss">:Base</span>
</span><span class='line'><span class="err">  </span><span class="n">queue_as</span> <span class="ss">:default</span>
</span><span class='line'>
</span><span class='line'><span class="err">  </span><span class="k">def</span> <span class="nf">perform</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</span><span class='line'><span class="err">    </span><span class="c1"># Do something later</span>
</span><span class='line'><span class="err">  </span><span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Enqueuing the Job</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">GuestsCleanupJob</span><span class="o">.</span><span class="n">enqueue</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
</span><span class='line'><span class="no">GuestsCleanupJob</span><span class="o">.</span><span class="n">enqueue</span><span class="p">(</span><span class="n">record</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Differences between latest ActiveJob</h2>

<ul>
<li>no rails generator for jobs.</li>
<li>no callback mechanism like <code>before_enqueue</code>, <code>before_perform</code> etc.</li>
<li>doesn’t load itself to rails app by default, that’s why you need a initializer to load it manually.</li>
<li>enqueue syntax is slightly different, in Rails 4.2.beta2 <code>enqueue</code> has changed to <code>perform_later</code>.</li>
<li>internally it’s using <a href="https://github.com/rails/activemodel-globalid">activemodel-globalid</a> instead of <a href="https://github.com/rails/globalid">GlobalID</a>(GlobalID is renamed from activemodel-globalid).</li>
<li>setting backend syntax is slightly different</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># Rails 4.2.beta2</span>
</span><span class='line'><span class="no">Rails</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">active_job</span><span class="o">.</span><span class="n">queue_adapter</span> <span class="o">=</span> <span class="ss">:delayed_job</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># Rails 4.1</span>
</span><span class='line'><span class="ss">ActiveJob</span><span class="p">:</span><span class="ss">:Base</span><span class="o">.</span><span class="n">queue_adapter</span> <span class="o">=</span> <span class="ss">:delayed_job</span>
</span></code></pre></td></tr></table></div></figure>


<p>p.s. I haven’t checked ActionMailer. I’m currently using it with DelayedJob and so far so good.</p>

<h2>Summary</h2>

<p>ActiveJob is very convenient, it provides a unified interface for the job infrastructure that allows you to switch the backend easily.</p>

<p>But as you can see there’re <strong>big diffs between the latest  developed version and the one now we’re able to install in Rails 4.1.</strong></p>

<p>Is it worth it to make the effort to try it now, and push these small upcoming changes when you upgrade to Rails 4.2 to your mental stack? My suggestion is <strong>if you’re just right about to implement a queue system and willing to adapt to it, then it’s OK</strong>, otherwise maybe better just leave the current app running as is and wait for a more mature timing.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2014-10-22T18:16:00+09:00" pubdate data-updated="true">2014-10-22</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/rails/'>Rails</a>


</div>
	
</div>
</article>


    <article class="post">
	<h1 class="title"><a href="/blog/rubykaigi-2014-3-good-talks-for-rails-developers/">RubyKaigi 2014 - 3 Good Talks for Rails Developers</a></h1>
	<div class="entry-content">
		<p>I went to <a href="http://rubykaigi.org/2014">Rubykaigi 2014</a> last week, there were lots of great talks about ruby itself, rails tips and more. Here I’ll share 3 things I feel worth to share for rails developers.</p>

<h2>Synvert</h2>

<p><a href="http://rubykaigi.org/2014/presentation/S-RichardHuang">Speaker page on Rubykaigi2014</a></p>

<blockquote><p>Synvert = syntax + convert, makes it easy to convert ruby code automatically</p></blockquote>

<p>Synvert is a gem made by the same author of <a href="https://github.com/flyerhzm/bullet">bullet</a> gem. Using it you can convert your rails 3 <code>before_filter</code> to rails 4 syntax <code>before_action</code>, rspec <code>should have</code> to <code>expect(…).to have</code> or ruby 1.8 hash to 1.9 hash syntax with just one command, and it does support more. It’s well tested so no worry for human error.</p>

<p>You could define your own rules to convert code, or use those built-in very common used snippets for rails, rspec and factory_girl.</p>

<h3>Installation and usage</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">gem</span> <span class="n">install</span> <span class="n">synvert</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># fetch snippets to ~/.synvert directory</span>
</span><span class='line'><span class="n">synvert</span> <span class="o">--</span><span class="n">sync</span>
</span><span class='line'>
</span><span class='line'><span class="n">synvert</span> <span class="o">-</span><span class="n">r</span> <span class="n">factory_girl</span><span class="o">/</span><span class="n">use_short_syntax</span>
</span></code></pre></td></tr></table></div></figure>


<p>Run <code>git diff</code> I got</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'><span class="gd">- user = FactoryGirl.create(:user)</span>
</span><span class='line'><span class="gi">+ user = create(:user)</span>
</span></code></pre></td></tr></table></div></figure>


<h3>How does it work</h3>

<p>AST(Abstract Syntax Tree) is used internally, it parses your source code to meaningful structures. It’s like grammar in English, one phrase can be broken down to words and some are noun, some are verb, it’s like saying “let’s replace all the verb ‘walk’ to ‘run’”.  I highly recommend you to check out the slide if you want to learn more.</p>

<p><img src="http://cdn.kinopyo.com/images/attributes_for_ast_node.png" alt="Example of attributes for AST node" /></p>

<p>For instance, it breaks a method call to receiver, message and arguments. A typical method call is a type of “send node”, class definition is “class node” and there is “block node”.</p>

<p>Links</p>

<ul>
<li><a href="https://speakerdeck.com/flyerhzm/write-ruby-code-to-change-ruby-code">Write ruby code to change ruby code </a></li>
<li><a href="https://github.com/xinminlabs/synvert">synvert gem</a></li>
<li><a href="http://synvert-tools.herokuapp.com">synvert playground</a></li>
</ul>


<h2>Going the distance</h2>

<p><a href="http://rubykaigi.org/2014/presentation/S-RichardSchneeman">Speaker page on Rubykaigi2014</a></p>

<p>To be honest I’m not sure I fully understand the algorithm of calculating distance between 2 words, but the great part is <a href="https://twitter.com/schneems">@ schneems</a> used it to improve rails generator command to suggest possible commands when you had a typo.</p>

<p>Please see the pull request for details. <a href="https://github.com/rails/rails/pull/15497">Emit suggested generator names when not found #15497</a></p>

<p>If you ever make a cli command, you could follow the same pattern, using the algorithm to suggest candidates instead of just showing plain error message.</p>

<p>Good to see how how he adapted scientific algorithm to solve real world problem.</p>

<h2>Speeding up Rails 4.2</h2>

<p><a href="http://rubykaigi.org/2014/presentation/S-AaronPatterson">Speaker page on Rubykaigi2014</a></p>

<p>Interesting to see how <a href="https://twitter.com/tenderlove">@tenderlove</a> find room for optimization and how to measure it.</p>

<p>Tools mentioned:</p>

<ul>
<li><a href="https://github.com/evanphx/benchmark-ips">benchmark-ips</a>, benchmarks a blocks iterations/second. For short snippits of code, ips automatically figures out how many times to run the code to get interesting data. No more guessing at random iteration counts!</li>
<li><a href="https://github.com/ko1/allocation_tracer">allocation_tracer</a>, allows to trace object allocation.</li>
</ul>


<p><a href="https://speakerdeck.com/tenderlove/gao-du-nakodo">Slide on speakerdeck</a></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2014-09-23T18:21:00+09:00" pubdate data-updated="true">2014-09-23</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/event/'>Event</a>


</div>
	
</div>
</article>

<nav id="pagenavi">
    
    
        <a href="/blog/page/2/" class="next">Next</a>
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav></div>
	<footer id="footer" class="inner">Copyright &copy; 2015

    Qihuan Piao

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'kinopyoblog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-33226278-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>



</body>
</html>